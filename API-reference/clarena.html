<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.1"/>
    <title>clarena API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>

            <h2>Contents</h2>
            <ul>
  <li><a href="#welcome-to-clarena">Welcome to CLArena</a></li>
</ul>


            <h2>Submodules</h2>
            <ul>
                    <li><a href="clarena/cl_datasets.html">cl_datasets</a></li>
                    <li><a href="clarena/backbones.html">backbones</a></li>
                    <li><a href="clarena/cl_heads.html">cl_heads</a></li>
                    <li><a href="clarena/cl_algorithms.html">cl_algorithms</a></li>
                    <li><a href="clarena/callbacks.html">callbacks</a></li>
                    <li><a href="clarena/utils.html">utils</a></li>
            </ul>

            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#CLExperiment">CLExperiment</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#CLExperiment.__init__">CLExperiment</a>
                        </li>
                        <li>
                                <a class="variable" href="#CLExperiment.cfg">cfg</a>
                        </li>
                        <li>
                                <a class="variable" href="#CLExperiment.cl_paradigm">cl_paradigm</a>
                        </li>
                        <li>
                                <a class="variable" href="#CLExperiment.num_tasks">num_tasks</a>
                        </li>
                        <li>
                                <a class="variable" href="#CLExperiment.global_seed">global_seed</a>
                        </li>
                        <li>
                                <a class="variable" href="#CLExperiment.test">test</a>
                        </li>
                        <li>
                                <a class="variable" href="#CLExperiment.output_dir_name">output_dir_name</a>
                        </li>
                        <li>
                                <a class="variable" href="#CLExperiment.task_id">task_id</a>
                        </li>
                        <li>
                                <a class="variable" href="#CLExperiment.cl_dataset">cl_dataset</a>
                        </li>
                        <li>
                                <a class="variable" href="#CLExperiment.backbone">backbone</a>
                        </li>
                        <li>
                                <a class="variable" href="#CLExperiment.heads">heads</a>
                        </li>
                        <li>
                                <a class="variable" href="#CLExperiment.model">model</a>
                        </li>
                        <li>
                                <a class="variable" href="#CLExperiment.optimizer">optimizer</a>
                        </li>
                        <li>
                                <a class="variable" href="#CLExperiment.trainer">trainer</a>
                        </li>
                        <li>
                                <a class="variable" href="#CLExperiment.lightning_loggers">lightning_loggers</a>
                        </li>
                        <li>
                                <a class="variable" href="#CLExperiment.callbacks">callbacks</a>
                        </li>
                        <li>
                                <a class="function" href="#CLExperiment.sanity_check">sanity_check</a>
                        </li>
                        <li>
                                <a class="function" href="#CLExperiment.instantiate_cl_dataset">instantiate_cl_dataset</a>
                        </li>
                        <li>
                                <a class="function" href="#CLExperiment.instantiate_backbone">instantiate_backbone</a>
                        </li>
                        <li>
                                <a class="function" href="#CLExperiment.instantiate_heads">instantiate_heads</a>
                        </li>
                        <li>
                                <a class="function" href="#CLExperiment.instantiate_cl_algorithm">instantiate_cl_algorithm</a>
                        </li>
                        <li>
                                <a class="function" href="#CLExperiment.instantiate_optimizer">instantiate_optimizer</a>
                        </li>
                        <li>
                                <a class="function" href="#CLExperiment.instantiate_trainer">instantiate_trainer</a>
                        </li>
                        <li>
                                <a class="function" href="#CLExperiment.instantiate_lightning_loggers">instantiate_lightning_loggers</a>
                        </li>
                        <li>
                                <a class="function" href="#CLExperiment.instantiate_callbacks">instantiate_callbacks</a>
                        </li>
                        <li>
                                <a class="function" href="#CLExperiment.set_global_seed">set_global_seed</a>
                        </li>
                        <li>
                                <a class="function" href="#CLExperiment.setup_task_id">setup_task_id</a>
                        </li>
                        <li>
                                <a class="function" href="#CLExperiment.instantiate_global">instantiate_global</a>
                        </li>
                        <li>
                                <a class="function" href="#CLExperiment.setup_global">setup_global</a>
                        </li>
                        <li>
                                <a class="function" href="#CLExperiment.instantiate_task_specific">instantiate_task_specific</a>
                        </li>
                        <li>
                                <a class="function" href="#CLExperiment.setup_task_specific">setup_task_specific</a>
                        </li>
                        <li>
                                <a class="function" href="#CLExperiment.run_task">run_task</a>
                        </li>
                        <li>
                                <a class="function" href="#CLExperiment.run">run</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
clarena    </h1>

                        <div class="docstring"><h1 id="welcome-to-clarena">Welcome to CLArena</h1>

<p><strong>CLArena (Continual Learning Arena)</strong> is a open-source Python package for Continual Learning (CL) research. In this package, we provide a integrated environment and various APIs to conduct CL experiments for research purposes, as well as implemented CL algorithms and datasets that you can give it a spin immediately.</p>

<p>Please note that this is an API documantation providing detailed information about the available classes, functions, and modules in CLArena. Please refer to the main documentation and my beginners' guide to continual learning for more intuitive tutorials, examples, and guides on how to use CLArena:</p>

<ul>
<li><a href="https://pengxiang-wang.com/projects/continual-learning-arena"><strong>Main Documentation</strong></a></li>
<li><a href="https://pengxiang-wang.com/posts/continual-learning-beginners-guide"><strong>A Beginners' Guide to Continual Learning</strong></a></li>
</ul>

<p>We provide various components of continual learning system in the submodules:</p>

<ul>
<li><code><a href="clarena/cl_datasets.html">clarena.cl_datasets</a></code>: Continual learning datasets.</li>
<li><code><a href="clarena/backbones.html">clarena.backbones</a></code>: Neural network architectures used as backbones for CL algorithms.</li>
<li><code><a href="clarena/cl_heads.html">clarena.cl_heads</a></code>: Multi-head classifiers for continual learning outputs. Task-Incremental Learning (TIL) head and Class-Incremental Learning (CIL) head are included.</li>
<li><code><a href="clarena/cl_algorithms.html">clarena.cl_algorithms</a></code>: Implementation of various continual learning algorithms.</li>
<li><code><a href="clarena/callbacks.html">clarena.callbacks</a></code>: Extra actions added in the continual learning process.</li>
<li><code>utils</code>: Utility functions for continual learning experiments.</li>
</ul>

<p>As well as the base class in the outmost directory of the package:</p>

<ul>
<li><code><a href="#CLExperiment">CLExperiment</a></code>: The base class for continual learning experiments.</li>
</ul>
</div>

                        <input id="mod-clarena-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-clarena-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a><span class="sd"># Welcome to CLArena</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a><span class="sd">**CLArena (Continual Learning Arena)** is a open-source Python package for Continual Learning (CL) research. In this package, we provide a integrated environment and various APIs to conduct CL experiments for research purposes, as well as implemented CL algorithms and datasets that you can give it a spin immediately.</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a><span class="sd">Please note that this is an API documantation providing detailed information about the available classes, functions, and modules in CLArena. Please refer to the main documentation and my beginners&#39; guide to continual learning for more intuitive tutorials, examples, and guides on how to use CLArena:</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a><span class="sd">- [**Main Documentation**](https://pengxiang-wang.com/projects/continual-learning-arena)</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a><span class="sd">- [**A Beginners&#39; Guide to Continual Learning**](https://pengxiang-wang.com/posts/continual-learning-beginners-guide)</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a><span class="sd">We provide various components of continual learning system in the submodules:</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a><span class="sd">- `clarena.cl_datasets`: Continual learning datasets.</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a><span class="sd">- `clarena.backbones`: Neural network architectures used as backbones for CL algorithms.</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">16</span></a><span class="sd">- `clarena.cl_heads`: Multi-head classifiers for continual learning outputs. Task-Incremental Learning (TIL) head and Class-Incremental Learning (CIL) head are included.</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">17</span></a><span class="sd">- `clarena.cl_algorithms`: Implementation of various continual learning algorithms.</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">18</span></a><span class="sd">- `clarena.callbacks`: Extra actions added in the continual learning process.</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">19</span></a><span class="sd">- `utils`: Utility functions for continual learning experiments.</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos">21</span></a><span class="sd">As well as the base class in the outmost directory of the package:</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">22</span></a>
</span><span id="L-23"><a href="#L-23"><span class="linenos">23</span></a><span class="sd">- `CLExperiment`: The base class for continual learning experiments.</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos">25</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos">27</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">CLExperiment</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">28</span></a>
</span><span id="L-29"><a href="#L-29"><span class="linenos">29</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">30</span></a>    <span class="s2">&quot;CLExperiment&quot;</span><span class="p">,</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">31</span></a>    <span class="s2">&quot;cl_datasets&quot;</span><span class="p">,</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">32</span></a>    <span class="s2">&quot;backbones&quot;</span><span class="p">,</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">33</span></a>    <span class="s2">&quot;cl_heads&quot;</span><span class="p">,</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">34</span></a>    <span class="s2">&quot;cl_algorithms&quot;</span><span class="p">,</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">35</span></a>    <span class="s2">&quot;callbacks&quot;</span><span class="p">,</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">36</span></a>    <span class="s2">&quot;utils&quot;</span><span class="p">,</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">37</span></a><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="CLExperiment">
                            <input id="CLExperiment-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CLExperiment</span>:

                <label class="view-source-button" for="CLExperiment-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CLExperiment"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CLExperiment-25"><a href="#CLExperiment-25"><span class="linenos"> 25</span></a><span class="k">class</span><span class="w"> </span><span class="nc">CLExperiment</span><span class="p">:</span>
</span><span id="CLExperiment-26"><a href="#CLExperiment-26"><span class="linenos"> 26</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The base class for continual learning experiments.&quot;&quot;&quot;</span>
</span><span id="CLExperiment-27"><a href="#CLExperiment-27"><span class="linenos"> 27</span></a>
</span><span id="CLExperiment-28"><a href="#CLExperiment-28"><span class="linenos"> 28</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment-29"><a href="#CLExperiment-29"><span class="linenos"> 29</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Initializes the CL experiment object with a complete configuration.</span>
</span><span id="CLExperiment-30"><a href="#CLExperiment-30"><span class="linenos"> 30</span></a>
</span><span id="CLExperiment-31"><a href="#CLExperiment-31"><span class="linenos"> 31</span></a><span class="sd">        **Args:**</span>
</span><span id="CLExperiment-32"><a href="#CLExperiment-32"><span class="linenos"> 32</span></a><span class="sd">        - **cfg** (`DictConfig`): the complete config dict for the CL experiment.</span>
</span><span id="CLExperiment-33"><a href="#CLExperiment-33"><span class="linenos"> 33</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CLExperiment-34"><a href="#CLExperiment-34"><span class="linenos"> 34</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">:</span> <span class="n">DictConfig</span> <span class="o">=</span> <span class="n">cfg</span>
</span><span id="CLExperiment-35"><a href="#CLExperiment-35"><span class="linenos"> 35</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Store the complete config dict for any future reference.&quot;&quot;&quot;</span>
</span><span id="CLExperiment-36"><a href="#CLExperiment-36"><span class="linenos"> 36</span></a>
</span><span id="CLExperiment-37"><a href="#CLExperiment-37"><span class="linenos"> 37</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cl_paradigm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">cl_paradigm</span>
</span><span id="CLExperiment-38"><a href="#CLExperiment-38"><span class="linenos"> 38</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Store the continual learning paradigm, either &#39;TIL&#39; (Task-Incremental Learning) or &#39;CIL&#39; (Class-Incremental Learning). Parsed from config and used to instantiate the correct heads object and set up CL dataset.&quot;&quot;&quot;</span>
</span><span id="CLExperiment-39"><a href="#CLExperiment-39"><span class="linenos"> 39</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">num_tasks</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">num_tasks</span>
</span><span id="CLExperiment-40"><a href="#CLExperiment-40"><span class="linenos"> 40</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Store the number of tasks to be conducted in this experiment. Parsed from config and used in the tasks loop.&quot;&quot;&quot;</span>
</span><span id="CLExperiment-41"><a href="#CLExperiment-41"><span class="linenos"> 41</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">global_seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">global_seed</span> <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;global_seed&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="CLExperiment-42"><a href="#CLExperiment-42"><span class="linenos"> 42</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Store the global seed for the entire experiment. Parsed from config and used to seed all random number generators.&quot;&quot;&quot;</span>
</span><span id="CLExperiment-43"><a href="#CLExperiment-43"><span class="linenos"> 43</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">test</span>
</span><span id="CLExperiment-44"><a href="#CLExperiment-44"><span class="linenos"> 44</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Store whether to test the model after training and validation. Parsed from config and used in the tasks loop.&quot;&quot;&quot;</span>
</span><span id="CLExperiment-45"><a href="#CLExperiment-45"><span class="linenos"> 45</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_dir_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">output_dir_name</span>
</span><span id="CLExperiment-46"><a href="#CLExperiment-46"><span class="linenos"> 46</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Store the name of the output directory to store the logs and checkpoints. Parsed from config and help any output operation to locate the correct directory.&quot;&quot;&quot;</span>
</span><span id="CLExperiment-47"><a href="#CLExperiment-47"><span class="linenos"> 47</span></a>
</span><span id="CLExperiment-48"><a href="#CLExperiment-48"><span class="linenos"> 48</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">task_id</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="CLExperiment-49"><a href="#CLExperiment-49"><span class="linenos"> 49</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Task ID counter indicating which task is being processed. Self updated during the task loop.&quot;&quot;&quot;</span>
</span><span id="CLExperiment-50"><a href="#CLExperiment-50"><span class="linenos"> 50</span></a>
</span><span id="CLExperiment-51"><a href="#CLExperiment-51"><span class="linenos"> 51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cl_dataset</span><span class="p">:</span> <span class="n">CLDataset</span>
</span><span id="CLExperiment-52"><a href="#CLExperiment-52"><span class="linenos"> 52</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;CL dataset object. Instantiate in `instantiate_cl_dataset()`.&quot;&quot;&quot;</span>
</span><span id="CLExperiment-53"><a href="#CLExperiment-53"><span class="linenos"> 53</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">backbone</span><span class="p">:</span> <span class="n">CLBackbone</span>
</span><span id="CLExperiment-54"><a href="#CLExperiment-54"><span class="linenos"> 54</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Backbone network object. Instantiate in `instantiate_backbone()`.&quot;&quot;&quot;</span>
</span><span id="CLExperiment-55"><a href="#CLExperiment-55"><span class="linenos"> 55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">heads</span><span class="p">:</span> <span class="n">HeadsTIL</span> <span class="o">|</span> <span class="n">HeadsCIL</span>
</span><span id="CLExperiment-56"><a href="#CLExperiment-56"><span class="linenos"> 56</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;CL output heads object. Instantiate in `instantiate_heads()`.&quot;&quot;&quot;</span>
</span><span id="CLExperiment-57"><a href="#CLExperiment-57"><span class="linenos"> 57</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">:</span> <span class="n">CLAlgorithm</span>
</span><span id="CLExperiment-58"><a href="#CLExperiment-58"><span class="linenos"> 58</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;CL model object. Instantiate in `instantiate_cl_algorithm()`.&quot;&quot;&quot;</span>
</span><span id="CLExperiment-59"><a href="#CLExperiment-59"><span class="linenos"> 59</span></a>
</span><span id="CLExperiment-60"><a href="#CLExperiment-60"><span class="linenos"> 60</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">:</span> <span class="n">Optimizer</span>
</span><span id="CLExperiment-61"><a href="#CLExperiment-61"><span class="linenos"> 61</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Optimizer object for current task `self.task_id`. Instantiate in `instantiate_optimizer()`.&quot;&quot;&quot;</span>
</span><span id="CLExperiment-62"><a href="#CLExperiment-62"><span class="linenos"> 62</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="p">:</span> <span class="n">Trainer</span>
</span><span id="CLExperiment-63"><a href="#CLExperiment-63"><span class="linenos"> 63</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Trainer object for current task `self.task_id`. Instantiate in `instantiate_trainer()`.&quot;&quot;&quot;</span>
</span><span id="CLExperiment-64"><a href="#CLExperiment-64"><span class="linenos"> 64</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lightning_loggers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Logger</span><span class="p">]</span>
</span><span id="CLExperiment-65"><a href="#CLExperiment-65"><span class="linenos"> 65</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The list of initialised lightning loggers objects for current task `self.task_id`. Instantiate in `instantiate_lightning_loggers()`.&quot;&quot;&quot;</span>
</span><span id="CLExperiment-66"><a href="#CLExperiment-66"><span class="linenos"> 66</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Callback</span><span class="p">]</span>
</span><span id="CLExperiment-67"><a href="#CLExperiment-67"><span class="linenos"> 67</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The list of initialised callbacks objects for current task `self.task_id`. Instantiate in `instantiate_callbacks()`.&quot;&quot;&quot;</span>
</span><span id="CLExperiment-68"><a href="#CLExperiment-68"><span class="linenos"> 68</span></a>
</span><span id="CLExperiment-69"><a href="#CLExperiment-69"><span class="linenos"> 69</span></a>        <span class="n">CLExperiment</span><span class="o">.</span><span class="n">sanity_check</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="CLExperiment-70"><a href="#CLExperiment-70"><span class="linenos"> 70</span></a>
</span><span id="CLExperiment-71"><a href="#CLExperiment-71"><span class="linenos"> 71</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sanity_check</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment-72"><a href="#CLExperiment-72"><span class="linenos"> 72</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Check the sanity of the config dict `self.cfg`.</span>
</span><span id="CLExperiment-73"><a href="#CLExperiment-73"><span class="linenos"> 73</span></a>
</span><span id="CLExperiment-74"><a href="#CLExperiment-74"><span class="linenos"> 74</span></a><span class="sd">        **Raises:**</span>
</span><span id="CLExperiment-75"><a href="#CLExperiment-75"><span class="linenos"> 75</span></a><span class="sd">        - **KeyError**: when required fields in experiment config are missing, including `cl_paradigm`, `num_tasks`, `test`, `output_dir_name`.</span>
</span><span id="CLExperiment-76"><a href="#CLExperiment-76"><span class="linenos"> 76</span></a><span class="sd">        - **ValueError**: when the value of `cl_paradigm` is not &#39;TIL&#39; or &#39;CIL&#39;, or when the number of tasks is larger than the number of tasks in the CL dataset.</span>
</span><span id="CLExperiment-77"><a href="#CLExperiment-77"><span class="linenos"> 77</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CLExperiment-78"><a href="#CLExperiment-78"><span class="linenos"> 78</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cl_paradigm&quot;</span><span class="p">):</span>
</span><span id="CLExperiment-79"><a href="#CLExperiment-79"><span class="linenos"> 79</span></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
</span><span id="CLExperiment-80"><a href="#CLExperiment-80"><span class="linenos"> 80</span></a>                <span class="s2">&quot;Field cl_paradigm should be specified in experiment config!&quot;</span>
</span><span id="CLExperiment-81"><a href="#CLExperiment-81"><span class="linenos"> 81</span></a>            <span class="p">)</span>
</span><span id="CLExperiment-82"><a href="#CLExperiment-82"><span class="linenos"> 82</span></a>
</span><span id="CLExperiment-83"><a href="#CLExperiment-83"><span class="linenos"> 83</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">cl_paradigm</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;TIL&quot;</span><span class="p">,</span> <span class="s2">&quot;CIL&quot;</span><span class="p">]:</span>
</span><span id="CLExperiment-84"><a href="#CLExperiment-84"><span class="linenos"> 84</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="CLExperiment-85"><a href="#CLExperiment-85"><span class="linenos"> 85</span></a>                <span class="sa">f</span><span class="s2">&quot;Field cl_paradigm should be either &#39;TIL&#39; or &#39;CIL&#39; but got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">cl_paradigm</span><span class="si">}</span><span class="s2">!&quot;</span>
</span><span id="CLExperiment-86"><a href="#CLExperiment-86"><span class="linenos"> 86</span></a>            <span class="p">)</span>
</span><span id="CLExperiment-87"><a href="#CLExperiment-87"><span class="linenos"> 87</span></a>
</span><span id="CLExperiment-88"><a href="#CLExperiment-88"><span class="linenos"> 88</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;num_tasks&quot;</span><span class="p">):</span>
</span><span id="CLExperiment-89"><a href="#CLExperiment-89"><span class="linenos"> 89</span></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Field num_tasks should be specified in experiment config!&quot;</span><span class="p">)</span>
</span><span id="CLExperiment-90"><a href="#CLExperiment-90"><span class="linenos"> 90</span></a>
</span><span id="CLExperiment-91"><a href="#CLExperiment-91"><span class="linenos"> 91</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">cl_dataset</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;num_tasks&quot;</span><span class="p">):</span>
</span><span id="CLExperiment-92"><a href="#CLExperiment-92"><span class="linenos"> 92</span></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Field num_tasks should be specified in cl_dataset config!&quot;</span><span class="p">)</span>
</span><span id="CLExperiment-93"><a href="#CLExperiment-93"><span class="linenos"> 93</span></a>
</span><span id="CLExperiment-94"><a href="#CLExperiment-94"><span class="linenos"> 94</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">num_tasks</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">cl_dataset</span><span class="o">.</span><span class="n">num_tasks</span><span class="p">:</span>
</span><span id="CLExperiment-95"><a href="#CLExperiment-95"><span class="linenos"> 95</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="CLExperiment-96"><a href="#CLExperiment-96"><span class="linenos"> 96</span></a>                <span class="sa">f</span><span class="s2">&quot;The experiment is set to run </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">num_tasks</span><span class="si">}</span><span class="s2"> tasks whereas only </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">cl_dataset</span><span class="o">.</span><span class="n">num_tasks</span><span class="si">}</span><span class="s2"> exists in current cl_dataset setting!&quot;</span>
</span><span id="CLExperiment-97"><a href="#CLExperiment-97"><span class="linenos"> 97</span></a>            <span class="p">)</span>
</span><span id="CLExperiment-98"><a href="#CLExperiment-98"><span class="linenos"> 98</span></a>
</span><span id="CLExperiment-99"><a href="#CLExperiment-99"><span class="linenos"> 99</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">):</span>
</span><span id="CLExperiment-100"><a href="#CLExperiment-100"><span class="linenos">100</span></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Field test should be specified in experiment config!&quot;</span><span class="p">)</span>
</span><span id="CLExperiment-101"><a href="#CLExperiment-101"><span class="linenos">101</span></a>
</span><span id="CLExperiment-102"><a href="#CLExperiment-102"><span class="linenos">102</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;output_dir_name&quot;</span><span class="p">):</span>
</span><span id="CLExperiment-103"><a href="#CLExperiment-103"><span class="linenos">103</span></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
</span><span id="CLExperiment-104"><a href="#CLExperiment-104"><span class="linenos">104</span></a>                <span class="s2">&quot;Field output_dir_name should be specified in experiment config!&quot;</span>
</span><span id="CLExperiment-105"><a href="#CLExperiment-105"><span class="linenos">105</span></a>            <span class="p">)</span>
</span><span id="CLExperiment-106"><a href="#CLExperiment-106"><span class="linenos">106</span></a>
</span><span id="CLExperiment-107"><a href="#CLExperiment-107"><span class="linenos">107</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">instantiate_cl_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cl_dataset_cfg</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment-108"><a href="#CLExperiment-108"><span class="linenos">108</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Instantiate the CL dataset object from cl_dataset config.</span>
</span><span id="CLExperiment-109"><a href="#CLExperiment-109"><span class="linenos">109</span></a>
</span><span id="CLExperiment-110"><a href="#CLExperiment-110"><span class="linenos">110</span></a><span class="sd">        **Args:**</span>
</span><span id="CLExperiment-111"><a href="#CLExperiment-111"><span class="linenos">111</span></a><span class="sd">        - **cl_dataset_cfg** (`DictConfig`): the cl_dataset config dict.</span>
</span><span id="CLExperiment-112"><a href="#CLExperiment-112"><span class="linenos">112</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CLExperiment-113"><a href="#CLExperiment-113"><span class="linenos">113</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment-114"><a href="#CLExperiment-114"><span class="linenos">114</span></a>            <span class="s2">&quot;Instantiating CL dataset &lt;</span><span class="si">%s</span><span class="s2">&gt; (clarena.cl_datasets.CLDataset)...&quot;</span><span class="p">,</span>
</span><span id="CLExperiment-115"><a href="#CLExperiment-115"><span class="linenos">115</span></a>            <span class="n">cl_dataset_cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_target_&quot;</span><span class="p">),</span>
</span><span id="CLExperiment-116"><a href="#CLExperiment-116"><span class="linenos">116</span></a>        <span class="p">)</span>
</span><span id="CLExperiment-117"><a href="#CLExperiment-117"><span class="linenos">117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cl_dataset</span><span class="p">:</span> <span class="n">LightningDataModule</span> <span class="o">=</span> <span class="n">hydra</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">cl_dataset_cfg</span><span class="p">)</span>
</span><span id="CLExperiment-118"><a href="#CLExperiment-118"><span class="linenos">118</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment-119"><a href="#CLExperiment-119"><span class="linenos">119</span></a>            <span class="s2">&quot;CL dataset &lt;</span><span class="si">%s</span><span class="s2">&gt; (clarena.cl_datasets.CLDataset) instantiated!&quot;</span><span class="p">,</span>
</span><span id="CLExperiment-120"><a href="#CLExperiment-120"><span class="linenos">120</span></a>            <span class="n">cl_dataset_cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_target_&quot;</span><span class="p">),</span>
</span><span id="CLExperiment-121"><a href="#CLExperiment-121"><span class="linenos">121</span></a>        <span class="p">)</span>
</span><span id="CLExperiment-122"><a href="#CLExperiment-122"><span class="linenos">122</span></a>
</span><span id="CLExperiment-123"><a href="#CLExperiment-123"><span class="linenos">123</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">instantiate_backbone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backbone_cfg</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment-124"><a href="#CLExperiment-124"><span class="linenos">124</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Instantiate the CL backbone network object from backbone config.</span>
</span><span id="CLExperiment-125"><a href="#CLExperiment-125"><span class="linenos">125</span></a>
</span><span id="CLExperiment-126"><a href="#CLExperiment-126"><span class="linenos">126</span></a><span class="sd">        **Args:**</span>
</span><span id="CLExperiment-127"><a href="#CLExperiment-127"><span class="linenos">127</span></a><span class="sd">        - **backbone_cfg** (`DictConfig`): the backbone config dict.</span>
</span><span id="CLExperiment-128"><a href="#CLExperiment-128"><span class="linenos">128</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CLExperiment-129"><a href="#CLExperiment-129"><span class="linenos">129</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment-130"><a href="#CLExperiment-130"><span class="linenos">130</span></a>            <span class="s2">&quot;Instantiating backbone network &lt;</span><span class="si">%s</span><span class="s2">&gt; (clarena.backbones.CLBackbone)...&quot;</span><span class="p">,</span>
</span><span id="CLExperiment-131"><a href="#CLExperiment-131"><span class="linenos">131</span></a>            <span class="n">backbone_cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_target_&quot;</span><span class="p">),</span>
</span><span id="CLExperiment-132"><a href="#CLExperiment-132"><span class="linenos">132</span></a>        <span class="p">)</span>
</span><span id="CLExperiment-133"><a href="#CLExperiment-133"><span class="linenos">133</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">backbone</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span> <span class="o">=</span> <span class="n">hydra</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">backbone_cfg</span><span class="p">)</span>
</span><span id="CLExperiment-134"><a href="#CLExperiment-134"><span class="linenos">134</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment-135"><a href="#CLExperiment-135"><span class="linenos">135</span></a>            <span class="s2">&quot;Backbone network &lt;</span><span class="si">%s</span><span class="s2">&gt; (clarena.backbones.CLBackbone) instantiated!&quot;</span><span class="p">,</span>
</span><span id="CLExperiment-136"><a href="#CLExperiment-136"><span class="linenos">136</span></a>            <span class="n">backbone_cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_target_&quot;</span><span class="p">),</span>
</span><span id="CLExperiment-137"><a href="#CLExperiment-137"><span class="linenos">137</span></a>        <span class="p">)</span>
</span><span id="CLExperiment-138"><a href="#CLExperiment-138"><span class="linenos">138</span></a>
</span><span id="CLExperiment-139"><a href="#CLExperiment-139"><span class="linenos">139</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">instantiate_heads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cl_paradigm</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">input_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment-140"><a href="#CLExperiment-140"><span class="linenos">140</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Instantiate the CL output heads object according to field `cl_paradigm` and backbone `output_dim` in the config.</span>
</span><span id="CLExperiment-141"><a href="#CLExperiment-141"><span class="linenos">141</span></a>
</span><span id="CLExperiment-142"><a href="#CLExperiment-142"><span class="linenos">142</span></a><span class="sd">        **Args:**</span>
</span><span id="CLExperiment-143"><a href="#CLExperiment-143"><span class="linenos">143</span></a><span class="sd">        - **cl_paradigm** (`str`): the CL paradigm, either &#39;TIL&#39; or &#39;CIL&#39;.</span>
</span><span id="CLExperiment-144"><a href="#CLExperiment-144"><span class="linenos">144</span></a><span class="sd">        - **input_dim** (`int`): the input dimension of the heads. Must be equal to the `output_dim` of the connected backbone.</span>
</span><span id="CLExperiment-145"><a href="#CLExperiment-145"><span class="linenos">145</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CLExperiment-146"><a href="#CLExperiment-146"><span class="linenos">146</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment-147"><a href="#CLExperiment-147"><span class="linenos">147</span></a>            <span class="s2">&quot;CL paradigm is set as </span><span class="si">%s</span><span class="s2">. Instantiating </span><span class="si">%s</span><span class="s2"> heads (torch.nn.Module)...&quot;</span><span class="p">,</span>
</span><span id="CLExperiment-148"><a href="#CLExperiment-148"><span class="linenos">148</span></a>            <span class="n">cl_paradigm</span><span class="p">,</span>
</span><span id="CLExperiment-149"><a href="#CLExperiment-149"><span class="linenos">149</span></a>            <span class="n">cl_paradigm</span><span class="p">,</span>
</span><span id="CLExperiment-150"><a href="#CLExperiment-150"><span class="linenos">150</span></a>        <span class="p">)</span>
</span><span id="CLExperiment-151"><a href="#CLExperiment-151"><span class="linenos">151</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">heads</span><span class="p">:</span> <span class="n">HeadsTIL</span> <span class="o">|</span> <span class="n">HeadsCIL</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="CLExperiment-152"><a href="#CLExperiment-152"><span class="linenos">152</span></a>            <span class="n">HeadsTIL</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="n">input_dim</span><span class="p">)</span>
</span><span id="CLExperiment-153"><a href="#CLExperiment-153"><span class="linenos">153</span></a>            <span class="k">if</span> <span class="n">cl_paradigm</span> <span class="o">==</span> <span class="s2">&quot;TIL&quot;</span>
</span><span id="CLExperiment-154"><a href="#CLExperiment-154"><span class="linenos">154</span></a>            <span class="k">else</span> <span class="n">HeadsCIL</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="n">input_dim</span><span class="p">)</span>
</span><span id="CLExperiment-155"><a href="#CLExperiment-155"><span class="linenos">155</span></a>        <span class="p">)</span>
</span><span id="CLExperiment-156"><a href="#CLExperiment-156"><span class="linenos">156</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> heads (torch.nn.Module) instantiated! &quot;</span><span class="p">,</span> <span class="n">cl_paradigm</span><span class="p">)</span>
</span><span id="CLExperiment-157"><a href="#CLExperiment-157"><span class="linenos">157</span></a>
</span><span id="CLExperiment-158"><a href="#CLExperiment-158"><span class="linenos">158</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">instantiate_cl_algorithm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cl_algorithm_cfg</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment-159"><a href="#CLExperiment-159"><span class="linenos">159</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Instantiate the cl_algorithm object from cl_algorithm config.</span>
</span><span id="CLExperiment-160"><a href="#CLExperiment-160"><span class="linenos">160</span></a>
</span><span id="CLExperiment-161"><a href="#CLExperiment-161"><span class="linenos">161</span></a><span class="sd">        **Args:**</span>
</span><span id="CLExperiment-162"><a href="#CLExperiment-162"><span class="linenos">162</span></a><span class="sd">        - **cl_algorithm_cfg** (`DictConfig`): the cl_algorithm config dict.</span>
</span><span id="CLExperiment-163"><a href="#CLExperiment-163"><span class="linenos">163</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CLExperiment-164"><a href="#CLExperiment-164"><span class="linenos">164</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment-165"><a href="#CLExperiment-165"><span class="linenos">165</span></a>            <span class="s2">&quot;CL algorithm is set as &lt;</span><span class="si">%s</span><span class="s2">&gt;. Instantiating &lt;</span><span class="si">%s</span><span class="s2">&gt; (clarena.cl_algorithms.CLAlgorithm)...&quot;</span><span class="p">,</span>
</span><span id="CLExperiment-166"><a href="#CLExperiment-166"><span class="linenos">166</span></a>            <span class="n">cl_algorithm_cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_target_&quot;</span><span class="p">),</span>
</span><span id="CLExperiment-167"><a href="#CLExperiment-167"><span class="linenos">167</span></a>            <span class="n">cl_algorithm_cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_target_&quot;</span><span class="p">),</span>
</span><span id="CLExperiment-168"><a href="#CLExperiment-168"><span class="linenos">168</span></a>        <span class="p">)</span>
</span><span id="CLExperiment-169"><a href="#CLExperiment-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">:</span> <span class="n">LightningModule</span> <span class="o">=</span> <span class="n">hydra</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span>
</span><span id="CLExperiment-170"><a href="#CLExperiment-170"><span class="linenos">170</span></a>            <span class="n">cl_algorithm_cfg</span><span class="p">,</span>
</span><span id="CLExperiment-171"><a href="#CLExperiment-171"><span class="linenos">171</span></a>            <span class="n">backbone</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backbone</span><span class="p">,</span>
</span><span id="CLExperiment-172"><a href="#CLExperiment-172"><span class="linenos">172</span></a>            <span class="n">heads</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">heads</span><span class="p">,</span>
</span><span id="CLExperiment-173"><a href="#CLExperiment-173"><span class="linenos">173</span></a>        <span class="p">)</span>
</span><span id="CLExperiment-174"><a href="#CLExperiment-174"><span class="linenos">174</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment-175"><a href="#CLExperiment-175"><span class="linenos">175</span></a>            <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; (clarena.cl_algorithms.CLAlgorithm) instantiated!&quot;</span><span class="p">,</span>
</span><span id="CLExperiment-176"><a href="#CLExperiment-176"><span class="linenos">176</span></a>            <span class="n">cl_algorithm_cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_target_&quot;</span><span class="p">),</span>
</span><span id="CLExperiment-177"><a href="#CLExperiment-177"><span class="linenos">177</span></a>        <span class="p">)</span>
</span><span id="CLExperiment-178"><a href="#CLExperiment-178"><span class="linenos">178</span></a>
</span><span id="CLExperiment-179"><a href="#CLExperiment-179"><span class="linenos">179</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">instantiate_optimizer</span><span class="p">(</span>
</span><span id="CLExperiment-180"><a href="#CLExperiment-180"><span class="linenos">180</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">optimizer_cfg</span><span class="p">:</span> <span class="n">DictConfig</span> <span class="o">|</span> <span class="n">ListConfig</span><span class="p">,</span> <span class="n">task_id</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="CLExperiment-181"><a href="#CLExperiment-181"><span class="linenos">181</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment-182"><a href="#CLExperiment-182"><span class="linenos">182</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Instantiate the optimizer object for task `task_id` from optimizer config.</span>
</span><span id="CLExperiment-183"><a href="#CLExperiment-183"><span class="linenos">183</span></a>
</span><span id="CLExperiment-184"><a href="#CLExperiment-184"><span class="linenos">184</span></a><span class="sd">        **Args:**</span>
</span><span id="CLExperiment-185"><a href="#CLExperiment-185"><span class="linenos">185</span></a><span class="sd">        - **optimizer_cfg** (`DictConfig` or `ListConfig`): the optimizer config dict. If it&#39;s a `ListConfig`, it should contain optimizer config for each task; otherwise, it&#39;s an uniform optimizer config for all tasks.</span>
</span><span id="CLExperiment-186"><a href="#CLExperiment-186"><span class="linenos">186</span></a><span class="sd">        - **task_id** (`int`): the target task ID.</span>
</span><span id="CLExperiment-187"><a href="#CLExperiment-187"><span class="linenos">187</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CLExperiment-188"><a href="#CLExperiment-188"><span class="linenos">188</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">optimizer_cfg</span><span class="p">,</span> <span class="n">ListConfig</span><span class="p">):</span>
</span><span id="CLExperiment-189"><a href="#CLExperiment-189"><span class="linenos">189</span></a>            <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Distinct optimizer config is applied to each task.&quot;</span><span class="p">)</span>
</span><span id="CLExperiment-190"><a href="#CLExperiment-190"><span class="linenos">190</span></a>            <span class="n">optimizer_cfg</span> <span class="o">=</span> <span class="n">optimizer_cfg</span><span class="p">[</span><span class="n">task_id</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="CLExperiment-191"><a href="#CLExperiment-191"><span class="linenos">191</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">optimizer_cfg</span><span class="p">,</span> <span class="n">DictConfig</span><span class="p">):</span>
</span><span id="CLExperiment-192"><a href="#CLExperiment-192"><span class="linenos">192</span></a>            <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Uniform optimizer config is applied to all tasks.&quot;</span><span class="p">)</span>
</span><span id="CLExperiment-193"><a href="#CLExperiment-193"><span class="linenos">193</span></a>
</span><span id="CLExperiment-194"><a href="#CLExperiment-194"><span class="linenos">194</span></a>            <span class="c1"># partially instantiate optimizer as the &#39;params&#39; argument is from Lightning Modules cannot be passed for now.</span>
</span><span id="CLExperiment-195"><a href="#CLExperiment-195"><span class="linenos">195</span></a>            <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment-196"><a href="#CLExperiment-196"><span class="linenos">196</span></a>                <span class="s2">&quot;Partially instantiating optimizer &lt;</span><span class="si">%s</span><span class="s2">&gt; (torch.optim.Optimizer) for task </span><span class="si">%d</span><span class="s2">...&quot;</span><span class="p">,</span>
</span><span id="CLExperiment-197"><a href="#CLExperiment-197"><span class="linenos">197</span></a>                <span class="n">optimizer_cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_target_&quot;</span><span class="p">),</span>
</span><span id="CLExperiment-198"><a href="#CLExperiment-198"><span class="linenos">198</span></a>                <span class="n">task_id</span><span class="p">,</span>
</span><span id="CLExperiment-199"><a href="#CLExperiment-199"><span class="linenos">199</span></a>            <span class="p">)</span>
</span><span id="CLExperiment-200"><a href="#CLExperiment-200"><span class="linenos">200</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">:</span> <span class="n">Optimizer</span> <span class="o">=</span> <span class="n">hydra</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">optimizer_cfg</span><span class="p">)</span>
</span><span id="CLExperiment-201"><a href="#CLExperiment-201"><span class="linenos">201</span></a>            <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment-202"><a href="#CLExperiment-202"><span class="linenos">202</span></a>                <span class="s2">&quot;Optimizer &lt;</span><span class="si">%s</span><span class="s2">&gt; (torch.optim.Optimizer) partially for task </span><span class="si">%d</span><span class="s2"> instantiated!&quot;</span><span class="p">,</span>
</span><span id="CLExperiment-203"><a href="#CLExperiment-203"><span class="linenos">203</span></a>                <span class="n">optimizer_cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_target_&quot;</span><span class="p">),</span>
</span><span id="CLExperiment-204"><a href="#CLExperiment-204"><span class="linenos">204</span></a>                <span class="n">task_id</span><span class="p">,</span>
</span><span id="CLExperiment-205"><a href="#CLExperiment-205"><span class="linenos">205</span></a>            <span class="p">)</span>
</span><span id="CLExperiment-206"><a href="#CLExperiment-206"><span class="linenos">206</span></a>
</span><span id="CLExperiment-207"><a href="#CLExperiment-207"><span class="linenos">207</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">instantiate_trainer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer_cfg</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">,</span> <span class="n">task_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment-208"><a href="#CLExperiment-208"><span class="linenos">208</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Instantiate the trainer object for task `task_id` from trainer config.</span>
</span><span id="CLExperiment-209"><a href="#CLExperiment-209"><span class="linenos">209</span></a>
</span><span id="CLExperiment-210"><a href="#CLExperiment-210"><span class="linenos">210</span></a><span class="sd">        **Args:**</span>
</span><span id="CLExperiment-211"><a href="#CLExperiment-211"><span class="linenos">211</span></a><span class="sd">        - **trainer_cfg** (`DictConfig`): the trainer config dict. All tasks share the same trainer config but different objects.</span>
</span><span id="CLExperiment-212"><a href="#CLExperiment-212"><span class="linenos">212</span></a><span class="sd">        - **task_id** (`int`): the target task ID.</span>
</span><span id="CLExperiment-213"><a href="#CLExperiment-213"><span class="linenos">213</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CLExperiment-214"><a href="#CLExperiment-214"><span class="linenos">214</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment-215"><a href="#CLExperiment-215"><span class="linenos">215</span></a>            <span class="s2">&quot;Instantiating trainer &lt;</span><span class="si">%s</span><span class="s2">&gt; (lightning.Trainer) for task </span><span class="si">%d</span><span class="s2">...&quot;</span><span class="p">,</span>
</span><span id="CLExperiment-216"><a href="#CLExperiment-216"><span class="linenos">216</span></a>            <span class="n">trainer_cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_target_&quot;</span><span class="p">),</span>
</span><span id="CLExperiment-217"><a href="#CLExperiment-217"><span class="linenos">217</span></a>            <span class="n">task_id</span><span class="p">,</span>
</span><span id="CLExperiment-218"><a href="#CLExperiment-218"><span class="linenos">218</span></a>        <span class="p">)</span>
</span><span id="CLExperiment-219"><a href="#CLExperiment-219"><span class="linenos">219</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="p">:</span> <span class="n">Trainer</span> <span class="o">=</span> <span class="n">hydra</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span>
</span><span id="CLExperiment-220"><a href="#CLExperiment-220"><span class="linenos">220</span></a>            <span class="n">trainer_cfg</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lightning_loggers</span>
</span><span id="CLExperiment-221"><a href="#CLExperiment-221"><span class="linenos">221</span></a>        <span class="p">)</span>
</span><span id="CLExperiment-222"><a href="#CLExperiment-222"><span class="linenos">222</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment-223"><a href="#CLExperiment-223"><span class="linenos">223</span></a>            <span class="s2">&quot;Trainer &lt;</span><span class="si">%s</span><span class="s2">&gt; (lightning.Trainer) for task </span><span class="si">%d</span><span class="s2"> instantiated!&quot;</span><span class="p">,</span>
</span><span id="CLExperiment-224"><a href="#CLExperiment-224"><span class="linenos">224</span></a>            <span class="n">trainer_cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_target_&quot;</span><span class="p">),</span>
</span><span id="CLExperiment-225"><a href="#CLExperiment-225"><span class="linenos">225</span></a>            <span class="n">task_id</span><span class="p">,</span>
</span><span id="CLExperiment-226"><a href="#CLExperiment-226"><span class="linenos">226</span></a>        <span class="p">)</span>
</span><span id="CLExperiment-227"><a href="#CLExperiment-227"><span class="linenos">227</span></a>
</span><span id="CLExperiment-228"><a href="#CLExperiment-228"><span class="linenos">228</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">instantiate_lightning_loggers</span><span class="p">(</span>
</span><span id="CLExperiment-229"><a href="#CLExperiment-229"><span class="linenos">229</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">lightning_loggers_cfg</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">,</span> <span class="n">task_id</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="CLExperiment-230"><a href="#CLExperiment-230"><span class="linenos">230</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment-231"><a href="#CLExperiment-231"><span class="linenos">231</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Instantiate the list of lightning loggers objects for task `task_id` from lightning_loggers config.</span>
</span><span id="CLExperiment-232"><a href="#CLExperiment-232"><span class="linenos">232</span></a>
</span><span id="CLExperiment-233"><a href="#CLExperiment-233"><span class="linenos">233</span></a><span class="sd">        **Args:**</span>
</span><span id="CLExperiment-234"><a href="#CLExperiment-234"><span class="linenos">234</span></a><span class="sd">        - **lightning_loggers_cfg** (`DictConfig`): the lightning_loggers config dict. All tasks share the same lightning_loggers config but different objects.</span>
</span><span id="CLExperiment-235"><a href="#CLExperiment-235"><span class="linenos">235</span></a><span class="sd">        - **task_id** (`int`): the target task ID.</span>
</span><span id="CLExperiment-236"><a href="#CLExperiment-236"><span class="linenos">236</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CLExperiment-237"><a href="#CLExperiment-237"><span class="linenos">237</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment-238"><a href="#CLExperiment-238"><span class="linenos">238</span></a>            <span class="s2">&quot;Instantiating Lightning loggers (lightning.Logger) for task </span><span class="si">%d</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">task_id</span>
</span><span id="CLExperiment-239"><a href="#CLExperiment-239"><span class="linenos">239</span></a>        <span class="p">)</span>
</span><span id="CLExperiment-240"><a href="#CLExperiment-240"><span class="linenos">240</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lightning_loggers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Logger</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="CLExperiment-241"><a href="#CLExperiment-241"><span class="linenos">241</span></a>            <span class="n">hydra</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span>
</span><span id="CLExperiment-242"><a href="#CLExperiment-242"><span class="linenos">242</span></a>                <span class="n">lightning_logger</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;task_</span><span class="si">{</span><span class="n">task_id</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="CLExperiment-243"><a href="#CLExperiment-243"><span class="linenos">243</span></a>            <span class="p">)</span>  <span class="c1"># change the directory name to &quot;task_&quot; prefix in lightning logs</span>
</span><span id="CLExperiment-244"><a href="#CLExperiment-244"><span class="linenos">244</span></a>            <span class="k">for</span> <span class="n">lightning_logger</span> <span class="ow">in</span> <span class="n">lightning_loggers_cfg</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="CLExperiment-245"><a href="#CLExperiment-245"><span class="linenos">245</span></a>        <span class="p">]</span>
</span><span id="CLExperiment-246"><a href="#CLExperiment-246"><span class="linenos">246</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment-247"><a href="#CLExperiment-247"><span class="linenos">247</span></a>            <span class="s2">&quot;Lightning loggers (lightning.Logger) for task </span><span class="si">%d</span><span class="s2"> instantiated!&quot;</span><span class="p">,</span> <span class="n">task_id</span>
</span><span id="CLExperiment-248"><a href="#CLExperiment-248"><span class="linenos">248</span></a>        <span class="p">)</span>
</span><span id="CLExperiment-249"><a href="#CLExperiment-249"><span class="linenos">249</span></a>
</span><span id="CLExperiment-250"><a href="#CLExperiment-250"><span class="linenos">250</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">instantiate_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callbacks_cfg</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">,</span> <span class="n">task_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment-251"><a href="#CLExperiment-251"><span class="linenos">251</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Instantiate the list of callbacks objects for task `task_id` from callbacks config.</span>
</span><span id="CLExperiment-252"><a href="#CLExperiment-252"><span class="linenos">252</span></a>
</span><span id="CLExperiment-253"><a href="#CLExperiment-253"><span class="linenos">253</span></a><span class="sd">        **Args:**</span>
</span><span id="CLExperiment-254"><a href="#CLExperiment-254"><span class="linenos">254</span></a><span class="sd">        - **callbacks_cfg** (`DictConfig`): the callbacks config dict. All tasks share the same callbacks config but different objects.</span>
</span><span id="CLExperiment-255"><a href="#CLExperiment-255"><span class="linenos">255</span></a><span class="sd">        - **task_id** (`int`): the target task ID.</span>
</span><span id="CLExperiment-256"><a href="#CLExperiment-256"><span class="linenos">256</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CLExperiment-257"><a href="#CLExperiment-257"><span class="linenos">257</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment-258"><a href="#CLExperiment-258"><span class="linenos">258</span></a>            <span class="s2">&quot;Instantiating callbacks (lightning.Callback) for task </span><span class="si">%d</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">task_id</span>
</span><span id="CLExperiment-259"><a href="#CLExperiment-259"><span class="linenos">259</span></a>        <span class="p">)</span>
</span><span id="CLExperiment-260"><a href="#CLExperiment-260"><span class="linenos">260</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Callback</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="CLExperiment-261"><a href="#CLExperiment-261"><span class="linenos">261</span></a>            <span class="n">hydra</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span> <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">callbacks_cfg</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="CLExperiment-262"><a href="#CLExperiment-262"><span class="linenos">262</span></a>        <span class="p">]</span>
</span><span id="CLExperiment-263"><a href="#CLExperiment-263"><span class="linenos">263</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment-264"><a href="#CLExperiment-264"><span class="linenos">264</span></a>            <span class="s2">&quot;Callbacks (lightning.Callback) for task </span><span class="si">%d</span><span class="s2"> instantiated!&quot;</span><span class="p">,</span> <span class="n">task_id</span>
</span><span id="CLExperiment-265"><a href="#CLExperiment-265"><span class="linenos">265</span></a>        <span class="p">)</span>
</span><span id="CLExperiment-266"><a href="#CLExperiment-266"><span class="linenos">266</span></a>
</span><span id="CLExperiment-267"><a href="#CLExperiment-267"><span class="linenos">267</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_global_seed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment-268"><a href="#CLExperiment-268"><span class="linenos">268</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Set the global seed for the entire experiment.&quot;&quot;&quot;</span>
</span><span id="CLExperiment-269"><a href="#CLExperiment-269"><span class="linenos">269</span></a>        <span class="n">L</span><span class="o">.</span><span class="n">seed_everything</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_seed</span><span class="p">,</span> <span class="n">workers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CLExperiment-270"><a href="#CLExperiment-270"><span class="linenos">270</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Global seed is set as </span><span class="si">%d</span><span class="s2">.&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_seed</span><span class="p">)</span>
</span><span id="CLExperiment-271"><a href="#CLExperiment-271"><span class="linenos">271</span></a>
</span><span id="CLExperiment-272"><a href="#CLExperiment-272"><span class="linenos">272</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">setup_task_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment-273"><a href="#CLExperiment-273"><span class="linenos">273</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Set up current task_id in the beginning of the continual learning process of a new task.</span>
</span><span id="CLExperiment-274"><a href="#CLExperiment-274"><span class="linenos">274</span></a>
</span><span id="CLExperiment-275"><a href="#CLExperiment-275"><span class="linenos">275</span></a><span class="sd">        **Args:**</span>
</span><span id="CLExperiment-276"><a href="#CLExperiment-276"><span class="linenos">276</span></a><span class="sd">        - **task_id** (`int`): current task_id.</span>
</span><span id="CLExperiment-277"><a href="#CLExperiment-277"><span class="linenos">277</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CLExperiment-278"><a href="#CLExperiment-278"><span class="linenos">278</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">task_id</span> <span class="o">=</span> <span class="n">task_id</span>
</span><span id="CLExperiment-279"><a href="#CLExperiment-279"><span class="linenos">279</span></a>
</span><span id="CLExperiment-280"><a href="#CLExperiment-280"><span class="linenos">280</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">instantiate_global</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment-281"><a href="#CLExperiment-281"><span class="linenos">281</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Instantiate global components for the entire CL experiment from `self.cfg`.&quot;&quot;&quot;</span>
</span><span id="CLExperiment-282"><a href="#CLExperiment-282"><span class="linenos">282</span></a>
</span><span id="CLExperiment-283"><a href="#CLExperiment-283"><span class="linenos">283</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instantiate_cl_dataset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">cl_dataset</span><span class="p">)</span>
</span><span id="CLExperiment-284"><a href="#CLExperiment-284"><span class="linenos">284</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instantiate_backbone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">backbone</span><span class="p">)</span>
</span><span id="CLExperiment-285"><a href="#CLExperiment-285"><span class="linenos">285</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instantiate_heads</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">cl_paradigm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">backbone</span><span class="o">.</span><span class="n">output_dim</span><span class="p">)</span>
</span><span id="CLExperiment-286"><a href="#CLExperiment-286"><span class="linenos">286</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instantiate_cl_algorithm</span><span class="p">(</span>
</span><span id="CLExperiment-287"><a href="#CLExperiment-287"><span class="linenos">287</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">cl_algorithm</span>
</span><span id="CLExperiment-288"><a href="#CLExperiment-288"><span class="linenos">288</span></a>        <span class="p">)</span>  <span class="c1"># cl_algorithm should be instantiated after backbone and heads</span>
</span><span id="CLExperiment-289"><a href="#CLExperiment-289"><span class="linenos">289</span></a>
</span><span id="CLExperiment-290"><a href="#CLExperiment-290"><span class="linenos">290</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">setup_global</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment-291"><a href="#CLExperiment-291"><span class="linenos">291</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Let CL dataset know the CL paradigm to define its CL class map.&quot;&quot;&quot;</span>
</span><span id="CLExperiment-292"><a href="#CLExperiment-292"><span class="linenos">292</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_global_seed</span><span class="p">()</span>
</span><span id="CLExperiment-293"><a href="#CLExperiment-293"><span class="linenos">293</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cl_dataset</span><span class="o">.</span><span class="n">set_cl_paradigm</span><span class="p">(</span><span class="n">cl_paradigm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cl_paradigm</span><span class="p">)</span>
</span><span id="CLExperiment-294"><a href="#CLExperiment-294"><span class="linenos">294</span></a>
</span><span id="CLExperiment-295"><a href="#CLExperiment-295"><span class="linenos">295</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">instantiate_task_specific</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment-296"><a href="#CLExperiment-296"><span class="linenos">296</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Instantiate task-specific components for the current task `self.task_id` from `self.cfg`.&quot;&quot;&quot;</span>
</span><span id="CLExperiment-297"><a href="#CLExperiment-297"><span class="linenos">297</span></a>
</span><span id="CLExperiment-298"><a href="#CLExperiment-298"><span class="linenos">298</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instantiate_optimizer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">optimizer</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_id</span><span class="p">)</span>
</span><span id="CLExperiment-299"><a href="#CLExperiment-299"><span class="linenos">299</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instantiate_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">callbacks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_id</span><span class="p">)</span>
</span><span id="CLExperiment-300"><a href="#CLExperiment-300"><span class="linenos">300</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instantiate_lightning_loggers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">lightning_loggers</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_id</span><span class="p">)</span>
</span><span id="CLExperiment-301"><a href="#CLExperiment-301"><span class="linenos">301</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instantiate_trainer</span><span class="p">(</span>
</span><span id="CLExperiment-302"><a href="#CLExperiment-302"><span class="linenos">302</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">trainer</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_id</span>
</span><span id="CLExperiment-303"><a href="#CLExperiment-303"><span class="linenos">303</span></a>        <span class="p">)</span>  <span class="c1"># trainer should be instantiated after loggers and callbacks</span>
</span><span id="CLExperiment-304"><a href="#CLExperiment-304"><span class="linenos">304</span></a>
</span><span id="CLExperiment-305"><a href="#CLExperiment-305"><span class="linenos">305</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">setup_task_specific</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment-306"><a href="#CLExperiment-306"><span class="linenos">306</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Setup task-specific components to get ready for the current task `self.task_id`.&quot;&quot;&quot;</span>
</span><span id="CLExperiment-307"><a href="#CLExperiment-307"><span class="linenos">307</span></a>
</span><span id="CLExperiment-308"><a href="#CLExperiment-308"><span class="linenos">308</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cl_dataset</span><span class="o">.</span><span class="n">setup_task_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">task_id</span><span class="p">)</span>
</span><span id="CLExperiment-309"><a href="#CLExperiment-309"><span class="linenos">309</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">backbone</span><span class="o">.</span><span class="n">setup_task_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">task_id</span><span class="p">)</span>
</span><span id="CLExperiment-310"><a href="#CLExperiment-310"><span class="linenos">310</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">setup_task_id</span><span class="p">(</span>
</span><span id="CLExperiment-311"><a href="#CLExperiment-311"><span class="linenos">311</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">task_id</span><span class="p">,</span>
</span><span id="CLExperiment-312"><a href="#CLExperiment-312"><span class="linenos">312</span></a>            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cl_dataset</span><span class="o">.</span><span class="n">cl_class_map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">task_id</span><span class="p">)),</span>
</span><span id="CLExperiment-313"><a href="#CLExperiment-313"><span class="linenos">313</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">,</span>
</span><span id="CLExperiment-314"><a href="#CLExperiment-314"><span class="linenos">314</span></a>        <span class="p">)</span>
</span><span id="CLExperiment-315"><a href="#CLExperiment-315"><span class="linenos">315</span></a>
</span><span id="CLExperiment-316"><a href="#CLExperiment-316"><span class="linenos">316</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment-317"><a href="#CLExperiment-317"><span class="linenos">317</span></a>            <span class="s2">&quot;Datamodule, model and loggers are all set up ready for task </span><span class="si">%d</span><span class="s2">!&quot;</span><span class="p">,</span>
</span><span id="CLExperiment-318"><a href="#CLExperiment-318"><span class="linenos">318</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">task_id</span><span class="p">,</span>
</span><span id="CLExperiment-319"><a href="#CLExperiment-319"><span class="linenos">319</span></a>        <span class="p">)</span>
</span><span id="CLExperiment-320"><a href="#CLExperiment-320"><span class="linenos">320</span></a>
</span><span id="CLExperiment-321"><a href="#CLExperiment-321"><span class="linenos">321</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run_task</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment-322"><a href="#CLExperiment-322"><span class="linenos">322</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Fit the model on the current task `self.task_id`. Also test the model if `self.test` is set to True.&quot;&quot;&quot;</span>
</span><span id="CLExperiment-323"><a href="#CLExperiment-323"><span class="linenos">323</span></a>
</span><span id="CLExperiment-324"><a href="#CLExperiment-324"><span class="linenos">324</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
</span><span id="CLExperiment-325"><a href="#CLExperiment-325"><span class="linenos">325</span></a>            <span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
</span><span id="CLExperiment-326"><a href="#CLExperiment-326"><span class="linenos">326</span></a>            <span class="n">datamodule</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cl_dataset</span><span class="p">,</span>
</span><span id="CLExperiment-327"><a href="#CLExperiment-327"><span class="linenos">327</span></a>        <span class="p">)</span>
</span><span id="CLExperiment-328"><a href="#CLExperiment-328"><span class="linenos">328</span></a>
</span><span id="CLExperiment-329"><a href="#CLExperiment-329"><span class="linenos">329</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="p">:</span>
</span><span id="CLExperiment-330"><a href="#CLExperiment-330"><span class="linenos">330</span></a>            <span class="c1"># test after training and validation</span>
</span><span id="CLExperiment-331"><a href="#CLExperiment-331"><span class="linenos">331</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">test</span><span class="p">(</span>
</span><span id="CLExperiment-332"><a href="#CLExperiment-332"><span class="linenos">332</span></a>                <span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
</span><span id="CLExperiment-333"><a href="#CLExperiment-333"><span class="linenos">333</span></a>                <span class="n">datamodule</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cl_dataset</span><span class="p">,</span>
</span><span id="CLExperiment-334"><a href="#CLExperiment-334"><span class="linenos">334</span></a>            <span class="p">)</span>
</span><span id="CLExperiment-335"><a href="#CLExperiment-335"><span class="linenos">335</span></a>
</span><span id="CLExperiment-336"><a href="#CLExperiment-336"><span class="linenos">336</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment-337"><a href="#CLExperiment-337"><span class="linenos">337</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The main method to run the continual learning experiment.&quot;&quot;&quot;</span>
</span><span id="CLExperiment-338"><a href="#CLExperiment-338"><span class="linenos">338</span></a>
</span><span id="CLExperiment-339"><a href="#CLExperiment-339"><span class="linenos">339</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instantiate_global</span><span class="p">()</span>
</span><span id="CLExperiment-340"><a href="#CLExperiment-340"><span class="linenos">340</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setup_global</span><span class="p">()</span>
</span><span id="CLExperiment-341"><a href="#CLExperiment-341"><span class="linenos">341</span></a>
</span><span id="CLExperiment-342"><a href="#CLExperiment-342"><span class="linenos">342</span></a>        <span class="c1"># task loop</span>
</span><span id="CLExperiment-343"><a href="#CLExperiment-343"><span class="linenos">343</span></a>        <span class="k">for</span> <span class="n">task_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_tasks</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>  <span class="c1"># task ID counts from 1</span>
</span><span id="CLExperiment-344"><a href="#CLExperiment-344"><span class="linenos">344</span></a>
</span><span id="CLExperiment-345"><a href="#CLExperiment-345"><span class="linenos">345</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">setup_task_id</span><span class="p">(</span><span class="n">task_id</span><span class="p">)</span>
</span><span id="CLExperiment-346"><a href="#CLExperiment-346"><span class="linenos">346</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">instantiate_task_specific</span><span class="p">()</span>
</span><span id="CLExperiment-347"><a href="#CLExperiment-347"><span class="linenos">347</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">setup_task_specific</span><span class="p">()</span>
</span><span id="CLExperiment-348"><a href="#CLExperiment-348"><span class="linenos">348</span></a>
</span><span id="CLExperiment-349"><a href="#CLExperiment-349"><span class="linenos">349</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">run_task</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>The base class for continual learning experiments.</p>
</div>


                            <div id="CLExperiment.__init__" class="classattr">
                                        <input id="CLExperiment.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">CLExperiment</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">cfg</span><span class="p">:</span> <span class="n">omegaconf</span><span class="o">.</span><span class="n">dictconfig</span><span class="o">.</span><span class="n">DictConfig</span></span>)</span>

                <label class="view-source-button" for="CLExperiment.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CLExperiment.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CLExperiment.__init__-28"><a href="#CLExperiment.__init__-28"><span class="linenos">28</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment.__init__-29"><a href="#CLExperiment.__init__-29"><span class="linenos">29</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Initializes the CL experiment object with a complete configuration.</span>
</span><span id="CLExperiment.__init__-30"><a href="#CLExperiment.__init__-30"><span class="linenos">30</span></a>
</span><span id="CLExperiment.__init__-31"><a href="#CLExperiment.__init__-31"><span class="linenos">31</span></a><span class="sd">        **Args:**</span>
</span><span id="CLExperiment.__init__-32"><a href="#CLExperiment.__init__-32"><span class="linenos">32</span></a><span class="sd">        - **cfg** (`DictConfig`): the complete config dict for the CL experiment.</span>
</span><span id="CLExperiment.__init__-33"><a href="#CLExperiment.__init__-33"><span class="linenos">33</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CLExperiment.__init__-34"><a href="#CLExperiment.__init__-34"><span class="linenos">34</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">:</span> <span class="n">DictConfig</span> <span class="o">=</span> <span class="n">cfg</span>
</span><span id="CLExperiment.__init__-35"><a href="#CLExperiment.__init__-35"><span class="linenos">35</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Store the complete config dict for any future reference.&quot;&quot;&quot;</span>
</span><span id="CLExperiment.__init__-36"><a href="#CLExperiment.__init__-36"><span class="linenos">36</span></a>
</span><span id="CLExperiment.__init__-37"><a href="#CLExperiment.__init__-37"><span class="linenos">37</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cl_paradigm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">cl_paradigm</span>
</span><span id="CLExperiment.__init__-38"><a href="#CLExperiment.__init__-38"><span class="linenos">38</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Store the continual learning paradigm, either &#39;TIL&#39; (Task-Incremental Learning) or &#39;CIL&#39; (Class-Incremental Learning). Parsed from config and used to instantiate the correct heads object and set up CL dataset.&quot;&quot;&quot;</span>
</span><span id="CLExperiment.__init__-39"><a href="#CLExperiment.__init__-39"><span class="linenos">39</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">num_tasks</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">num_tasks</span>
</span><span id="CLExperiment.__init__-40"><a href="#CLExperiment.__init__-40"><span class="linenos">40</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Store the number of tasks to be conducted in this experiment. Parsed from config and used in the tasks loop.&quot;&quot;&quot;</span>
</span><span id="CLExperiment.__init__-41"><a href="#CLExperiment.__init__-41"><span class="linenos">41</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">global_seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">global_seed</span> <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;global_seed&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="CLExperiment.__init__-42"><a href="#CLExperiment.__init__-42"><span class="linenos">42</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Store the global seed for the entire experiment. Parsed from config and used to seed all random number generators.&quot;&quot;&quot;</span>
</span><span id="CLExperiment.__init__-43"><a href="#CLExperiment.__init__-43"><span class="linenos">43</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">test</span>
</span><span id="CLExperiment.__init__-44"><a href="#CLExperiment.__init__-44"><span class="linenos">44</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Store whether to test the model after training and validation. Parsed from config and used in the tasks loop.&quot;&quot;&quot;</span>
</span><span id="CLExperiment.__init__-45"><a href="#CLExperiment.__init__-45"><span class="linenos">45</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_dir_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">output_dir_name</span>
</span><span id="CLExperiment.__init__-46"><a href="#CLExperiment.__init__-46"><span class="linenos">46</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Store the name of the output directory to store the logs and checkpoints. Parsed from config and help any output operation to locate the correct directory.&quot;&quot;&quot;</span>
</span><span id="CLExperiment.__init__-47"><a href="#CLExperiment.__init__-47"><span class="linenos">47</span></a>
</span><span id="CLExperiment.__init__-48"><a href="#CLExperiment.__init__-48"><span class="linenos">48</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">task_id</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="CLExperiment.__init__-49"><a href="#CLExperiment.__init__-49"><span class="linenos">49</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Task ID counter indicating which task is being processed. Self updated during the task loop.&quot;&quot;&quot;</span>
</span><span id="CLExperiment.__init__-50"><a href="#CLExperiment.__init__-50"><span class="linenos">50</span></a>
</span><span id="CLExperiment.__init__-51"><a href="#CLExperiment.__init__-51"><span class="linenos">51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cl_dataset</span><span class="p">:</span> <span class="n">CLDataset</span>
</span><span id="CLExperiment.__init__-52"><a href="#CLExperiment.__init__-52"><span class="linenos">52</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;CL dataset object. Instantiate in `instantiate_cl_dataset()`.&quot;&quot;&quot;</span>
</span><span id="CLExperiment.__init__-53"><a href="#CLExperiment.__init__-53"><span class="linenos">53</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">backbone</span><span class="p">:</span> <span class="n">CLBackbone</span>
</span><span id="CLExperiment.__init__-54"><a href="#CLExperiment.__init__-54"><span class="linenos">54</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Backbone network object. Instantiate in `instantiate_backbone()`.&quot;&quot;&quot;</span>
</span><span id="CLExperiment.__init__-55"><a href="#CLExperiment.__init__-55"><span class="linenos">55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">heads</span><span class="p">:</span> <span class="n">HeadsTIL</span> <span class="o">|</span> <span class="n">HeadsCIL</span>
</span><span id="CLExperiment.__init__-56"><a href="#CLExperiment.__init__-56"><span class="linenos">56</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;CL output heads object. Instantiate in `instantiate_heads()`.&quot;&quot;&quot;</span>
</span><span id="CLExperiment.__init__-57"><a href="#CLExperiment.__init__-57"><span class="linenos">57</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">:</span> <span class="n">CLAlgorithm</span>
</span><span id="CLExperiment.__init__-58"><a href="#CLExperiment.__init__-58"><span class="linenos">58</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;CL model object. Instantiate in `instantiate_cl_algorithm()`.&quot;&quot;&quot;</span>
</span><span id="CLExperiment.__init__-59"><a href="#CLExperiment.__init__-59"><span class="linenos">59</span></a>
</span><span id="CLExperiment.__init__-60"><a href="#CLExperiment.__init__-60"><span class="linenos">60</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">:</span> <span class="n">Optimizer</span>
</span><span id="CLExperiment.__init__-61"><a href="#CLExperiment.__init__-61"><span class="linenos">61</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Optimizer object for current task `self.task_id`. Instantiate in `instantiate_optimizer()`.&quot;&quot;&quot;</span>
</span><span id="CLExperiment.__init__-62"><a href="#CLExperiment.__init__-62"><span class="linenos">62</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="p">:</span> <span class="n">Trainer</span>
</span><span id="CLExperiment.__init__-63"><a href="#CLExperiment.__init__-63"><span class="linenos">63</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Trainer object for current task `self.task_id`. Instantiate in `instantiate_trainer()`.&quot;&quot;&quot;</span>
</span><span id="CLExperiment.__init__-64"><a href="#CLExperiment.__init__-64"><span class="linenos">64</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lightning_loggers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Logger</span><span class="p">]</span>
</span><span id="CLExperiment.__init__-65"><a href="#CLExperiment.__init__-65"><span class="linenos">65</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The list of initialised lightning loggers objects for current task `self.task_id`. Instantiate in `instantiate_lightning_loggers()`.&quot;&quot;&quot;</span>
</span><span id="CLExperiment.__init__-66"><a href="#CLExperiment.__init__-66"><span class="linenos">66</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Callback</span><span class="p">]</span>
</span><span id="CLExperiment.__init__-67"><a href="#CLExperiment.__init__-67"><span class="linenos">67</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The list of initialised callbacks objects for current task `self.task_id`. Instantiate in `instantiate_callbacks()`.&quot;&quot;&quot;</span>
</span><span id="CLExperiment.__init__-68"><a href="#CLExperiment.__init__-68"><span class="linenos">68</span></a>
</span><span id="CLExperiment.__init__-69"><a href="#CLExperiment.__init__-69"><span class="linenos">69</span></a>        <span class="n">CLExperiment</span><span class="o">.</span><span class="n">sanity_check</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initializes the CL experiment object with a complete configuration.</p>

<p><strong>Args:</strong></p>

<ul>
<li><strong>cfg</strong> (<code>DictConfig</code>): the complete config dict for the CL experiment.</li>
</ul>
</div>


                            </div>
                            <div id="CLExperiment.cfg" class="classattr">
                                <div class="attr variable">
            <span class="name">cfg</span><span class="annotation">: omegaconf.dictconfig.DictConfig</span>

        
    </div>
    <a class="headerlink" href="#CLExperiment.cfg"></a>
    
            <div class="docstring"><p>Store the complete config dict for any future reference.</p>
</div>


                            </div>
                            <div id="CLExperiment.cl_paradigm" class="classattr">
                                <div class="attr variable">
            <span class="name">cl_paradigm</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#CLExperiment.cl_paradigm"></a>
    
            <div class="docstring"><p>Store the continual learning paradigm, either 'TIL' (Task-Incremental Learning) or 'CIL' (Class-Incremental Learning). Parsed from config and used to instantiate the correct heads object and set up CL dataset.</p>
</div>


                            </div>
                            <div id="CLExperiment.num_tasks" class="classattr">
                                <div class="attr variable">
            <span class="name">num_tasks</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#CLExperiment.num_tasks"></a>
    
            <div class="docstring"><p>Store the number of tasks to be conducted in this experiment. Parsed from config and used in the tasks loop.</p>
</div>


                            </div>
                            <div id="CLExperiment.global_seed" class="classattr">
                                <div class="attr variable">
            <span class="name">global_seed</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#CLExperiment.global_seed"></a>
    
            <div class="docstring"><p>Store the global seed for the entire experiment. Parsed from config and used to seed all random number generators.</p>
</div>


                            </div>
                            <div id="CLExperiment.test" class="classattr">
                                <div class="attr variable">
            <span class="name">test</span><span class="annotation">: bool</span>

        
    </div>
    <a class="headerlink" href="#CLExperiment.test"></a>
    
            <div class="docstring"><p>Store whether to test the model after training and validation. Parsed from config and used in the tasks loop.</p>
</div>


                            </div>
                            <div id="CLExperiment.output_dir_name" class="classattr">
                                <div class="attr variable">
            <span class="name">output_dir_name</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#CLExperiment.output_dir_name"></a>
    
            <div class="docstring"><p>Store the name of the output directory to store the logs and checkpoints. Parsed from config and help any output operation to locate the correct directory.</p>
</div>


                            </div>
                            <div id="CLExperiment.task_id" class="classattr">
                                <div class="attr variable">
            <span class="name">task_id</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#CLExperiment.task_id"></a>
    
            <div class="docstring"><p>Task ID counter indicating which task is being processed. Self updated during the task loop.</p>
</div>


                            </div>
                            <div id="CLExperiment.cl_dataset" class="classattr">
                                <div class="attr variable">
            <span class="name">cl_dataset</span><span class="annotation">: <a href="clarena/cl_datasets.html#CLDataset">clarena.cl_datasets.CLDataset</a></span>

        
    </div>
    <a class="headerlink" href="#CLExperiment.cl_dataset"></a>
    
            <div class="docstring"><p>CL dataset object. Instantiate in <code><a href="#CLExperiment.instantiate_cl_dataset">instantiate_cl_dataset()</a></code>.</p>
</div>


                            </div>
                            <div id="CLExperiment.backbone" class="classattr">
                                <div class="attr variable">
            <span class="name">backbone</span><span class="annotation">: <a href="clarena/backbones.html#CLBackbone">clarena.backbones.CLBackbone</a></span>

        
    </div>
    <a class="headerlink" href="#CLExperiment.backbone"></a>
    
            <div class="docstring"><p>Backbone network object. Instantiate in <code><a href="#CLExperiment.instantiate_backbone">instantiate_backbone()</a></code>.</p>
</div>


                            </div>
                            <div id="CLExperiment.heads" class="classattr">
                                <div class="attr variable">
            <span class="name">heads</span><span class="annotation">: <a href="clarena/cl_heads.html#HeadsTIL">clarena.cl_heads.HeadsTIL</a> | <a href="clarena/cl_heads.html#HeadsCIL">clarena.cl_heads.HeadsCIL</a></span>

        
    </div>
    <a class="headerlink" href="#CLExperiment.heads"></a>
    
            <div class="docstring"><p>CL output heads object. Instantiate in <code><a href="#CLExperiment.instantiate_heads">instantiate_heads()</a></code>.</p>
</div>


                            </div>
                            <div id="CLExperiment.model" class="classattr">
                                <div class="attr variable">
            <span class="name">model</span><span class="annotation">: <a href="clarena/cl_algorithms.html#CLAlgorithm">clarena.cl_algorithms.CLAlgorithm</a></span>

        
    </div>
    <a class="headerlink" href="#CLExperiment.model"></a>
    
            <div class="docstring"><p>CL model object. Instantiate in <code><a href="#CLExperiment.instantiate_cl_algorithm">instantiate_cl_algorithm()</a></code>.</p>
</div>


                            </div>
                            <div id="CLExperiment.optimizer" class="classattr">
                                <div class="attr variable">
            <span class="name">optimizer</span><span class="annotation">: torch.optim.optimizer.Optimizer</span>

        
    </div>
    <a class="headerlink" href="#CLExperiment.optimizer"></a>
    
            <div class="docstring"><p>Optimizer object for current task <code>self.task_id</code>. Instantiate in <code><a href="#CLExperiment.instantiate_optimizer">instantiate_optimizer()</a></code>.</p>
</div>


                            </div>
                            <div id="CLExperiment.trainer" class="classattr">
                                <div class="attr variable">
            <span class="name">trainer</span><span class="annotation">: lightning.pytorch.trainer.trainer.Trainer</span>

        
    </div>
    <a class="headerlink" href="#CLExperiment.trainer"></a>
    
            <div class="docstring"><p>Trainer object for current task <code>self.task_id</code>. Instantiate in <code><a href="#CLExperiment.instantiate_trainer">instantiate_trainer()</a></code>.</p>
</div>


                            </div>
                            <div id="CLExperiment.lightning_loggers" class="classattr">
                                <div class="attr variable">
            <span class="name">lightning_loggers</span><span class="annotation">: list[lightning.pytorch.loggers.logger.Logger]</span>

        
    </div>
    <a class="headerlink" href="#CLExperiment.lightning_loggers"></a>
    
            <div class="docstring"><p>The list of initialised lightning loggers objects for current task <code>self.task_id</code>. Instantiate in <code><a href="#CLExperiment.instantiate_lightning_loggers">instantiate_lightning_loggers()</a></code>.</p>
</div>


                            </div>
                            <div id="CLExperiment.callbacks" class="classattr">
                                <div class="attr variable">
            <span class="name">callbacks</span><span class="annotation">: list[lightning.pytorch.callbacks.callback.Callback]</span>

        
    </div>
    <a class="headerlink" href="#CLExperiment.callbacks"></a>
    
            <div class="docstring"><p>The list of initialised callbacks objects for current task <code>self.task_id</code>. Instantiate in <code><a href="#CLExperiment.instantiate_callbacks">instantiate_callbacks()</a></code>.</p>
</div>


                            </div>
                            <div id="CLExperiment.sanity_check" class="classattr">
                                        <input id="CLExperiment.sanity_check-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sanity_check</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CLExperiment.sanity_check-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CLExperiment.sanity_check"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CLExperiment.sanity_check-71"><a href="#CLExperiment.sanity_check-71"><span class="linenos"> 71</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sanity_check</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment.sanity_check-72"><a href="#CLExperiment.sanity_check-72"><span class="linenos"> 72</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Check the sanity of the config dict `self.cfg`.</span>
</span><span id="CLExperiment.sanity_check-73"><a href="#CLExperiment.sanity_check-73"><span class="linenos"> 73</span></a>
</span><span id="CLExperiment.sanity_check-74"><a href="#CLExperiment.sanity_check-74"><span class="linenos"> 74</span></a><span class="sd">        **Raises:**</span>
</span><span id="CLExperiment.sanity_check-75"><a href="#CLExperiment.sanity_check-75"><span class="linenos"> 75</span></a><span class="sd">        - **KeyError**: when required fields in experiment config are missing, including `cl_paradigm`, `num_tasks`, `test`, `output_dir_name`.</span>
</span><span id="CLExperiment.sanity_check-76"><a href="#CLExperiment.sanity_check-76"><span class="linenos"> 76</span></a><span class="sd">        - **ValueError**: when the value of `cl_paradigm` is not &#39;TIL&#39; or &#39;CIL&#39;, or when the number of tasks is larger than the number of tasks in the CL dataset.</span>
</span><span id="CLExperiment.sanity_check-77"><a href="#CLExperiment.sanity_check-77"><span class="linenos"> 77</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CLExperiment.sanity_check-78"><a href="#CLExperiment.sanity_check-78"><span class="linenos"> 78</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cl_paradigm&quot;</span><span class="p">):</span>
</span><span id="CLExperiment.sanity_check-79"><a href="#CLExperiment.sanity_check-79"><span class="linenos"> 79</span></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
</span><span id="CLExperiment.sanity_check-80"><a href="#CLExperiment.sanity_check-80"><span class="linenos"> 80</span></a>                <span class="s2">&quot;Field cl_paradigm should be specified in experiment config!&quot;</span>
</span><span id="CLExperiment.sanity_check-81"><a href="#CLExperiment.sanity_check-81"><span class="linenos"> 81</span></a>            <span class="p">)</span>
</span><span id="CLExperiment.sanity_check-82"><a href="#CLExperiment.sanity_check-82"><span class="linenos"> 82</span></a>
</span><span id="CLExperiment.sanity_check-83"><a href="#CLExperiment.sanity_check-83"><span class="linenos"> 83</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">cl_paradigm</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;TIL&quot;</span><span class="p">,</span> <span class="s2">&quot;CIL&quot;</span><span class="p">]:</span>
</span><span id="CLExperiment.sanity_check-84"><a href="#CLExperiment.sanity_check-84"><span class="linenos"> 84</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="CLExperiment.sanity_check-85"><a href="#CLExperiment.sanity_check-85"><span class="linenos"> 85</span></a>                <span class="sa">f</span><span class="s2">&quot;Field cl_paradigm should be either &#39;TIL&#39; or &#39;CIL&#39; but got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">cl_paradigm</span><span class="si">}</span><span class="s2">!&quot;</span>
</span><span id="CLExperiment.sanity_check-86"><a href="#CLExperiment.sanity_check-86"><span class="linenos"> 86</span></a>            <span class="p">)</span>
</span><span id="CLExperiment.sanity_check-87"><a href="#CLExperiment.sanity_check-87"><span class="linenos"> 87</span></a>
</span><span id="CLExperiment.sanity_check-88"><a href="#CLExperiment.sanity_check-88"><span class="linenos"> 88</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;num_tasks&quot;</span><span class="p">):</span>
</span><span id="CLExperiment.sanity_check-89"><a href="#CLExperiment.sanity_check-89"><span class="linenos"> 89</span></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Field num_tasks should be specified in experiment config!&quot;</span><span class="p">)</span>
</span><span id="CLExperiment.sanity_check-90"><a href="#CLExperiment.sanity_check-90"><span class="linenos"> 90</span></a>
</span><span id="CLExperiment.sanity_check-91"><a href="#CLExperiment.sanity_check-91"><span class="linenos"> 91</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">cl_dataset</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;num_tasks&quot;</span><span class="p">):</span>
</span><span id="CLExperiment.sanity_check-92"><a href="#CLExperiment.sanity_check-92"><span class="linenos"> 92</span></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Field num_tasks should be specified in cl_dataset config!&quot;</span><span class="p">)</span>
</span><span id="CLExperiment.sanity_check-93"><a href="#CLExperiment.sanity_check-93"><span class="linenos"> 93</span></a>
</span><span id="CLExperiment.sanity_check-94"><a href="#CLExperiment.sanity_check-94"><span class="linenos"> 94</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">num_tasks</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">cl_dataset</span><span class="o">.</span><span class="n">num_tasks</span><span class="p">:</span>
</span><span id="CLExperiment.sanity_check-95"><a href="#CLExperiment.sanity_check-95"><span class="linenos"> 95</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="CLExperiment.sanity_check-96"><a href="#CLExperiment.sanity_check-96"><span class="linenos"> 96</span></a>                <span class="sa">f</span><span class="s2">&quot;The experiment is set to run </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">num_tasks</span><span class="si">}</span><span class="s2"> tasks whereas only </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">cl_dataset</span><span class="o">.</span><span class="n">num_tasks</span><span class="si">}</span><span class="s2"> exists in current cl_dataset setting!&quot;</span>
</span><span id="CLExperiment.sanity_check-97"><a href="#CLExperiment.sanity_check-97"><span class="linenos"> 97</span></a>            <span class="p">)</span>
</span><span id="CLExperiment.sanity_check-98"><a href="#CLExperiment.sanity_check-98"><span class="linenos"> 98</span></a>
</span><span id="CLExperiment.sanity_check-99"><a href="#CLExperiment.sanity_check-99"><span class="linenos"> 99</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">):</span>
</span><span id="CLExperiment.sanity_check-100"><a href="#CLExperiment.sanity_check-100"><span class="linenos">100</span></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Field test should be specified in experiment config!&quot;</span><span class="p">)</span>
</span><span id="CLExperiment.sanity_check-101"><a href="#CLExperiment.sanity_check-101"><span class="linenos">101</span></a>
</span><span id="CLExperiment.sanity_check-102"><a href="#CLExperiment.sanity_check-102"><span class="linenos">102</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;output_dir_name&quot;</span><span class="p">):</span>
</span><span id="CLExperiment.sanity_check-103"><a href="#CLExperiment.sanity_check-103"><span class="linenos">103</span></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
</span><span id="CLExperiment.sanity_check-104"><a href="#CLExperiment.sanity_check-104"><span class="linenos">104</span></a>                <span class="s2">&quot;Field output_dir_name should be specified in experiment config!&quot;</span>
</span><span id="CLExperiment.sanity_check-105"><a href="#CLExperiment.sanity_check-105"><span class="linenos">105</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Check the sanity of the config dict <code>self.cfg</code>.</p>

<p><strong>Raises:</strong></p>

<ul>
<li><strong>KeyError</strong>: when required fields in experiment config are missing, including <code><a href="#CLExperiment.cl_paradigm">cl_paradigm</a></code>, <code><a href="#CLExperiment.num_tasks">num_tasks</a></code>, <code><a href="#CLExperiment.test">test</a></code>, <code><a href="#CLExperiment.output_dir_name">output_dir_name</a></code>.</li>
<li><strong>ValueError</strong>: when the value of <code><a href="#CLExperiment.cl_paradigm">cl_paradigm</a></code> is not 'TIL' or 'CIL', or when the number of tasks is larger than the number of tasks in the CL dataset.</li>
</ul>
</div>


                            </div>
                            <div id="CLExperiment.instantiate_cl_dataset" class="classattr">
                                        <input id="CLExperiment.instantiate_cl_dataset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">instantiate_cl_dataset</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">cl_dataset_cfg</span><span class="p">:</span> <span class="n">omegaconf</span><span class="o">.</span><span class="n">dictconfig</span><span class="o">.</span><span class="n">DictConfig</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CLExperiment.instantiate_cl_dataset-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CLExperiment.instantiate_cl_dataset"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CLExperiment.instantiate_cl_dataset-107"><a href="#CLExperiment.instantiate_cl_dataset-107"><span class="linenos">107</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">instantiate_cl_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cl_dataset_cfg</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment.instantiate_cl_dataset-108"><a href="#CLExperiment.instantiate_cl_dataset-108"><span class="linenos">108</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Instantiate the CL dataset object from cl_dataset config.</span>
</span><span id="CLExperiment.instantiate_cl_dataset-109"><a href="#CLExperiment.instantiate_cl_dataset-109"><span class="linenos">109</span></a>
</span><span id="CLExperiment.instantiate_cl_dataset-110"><a href="#CLExperiment.instantiate_cl_dataset-110"><span class="linenos">110</span></a><span class="sd">        **Args:**</span>
</span><span id="CLExperiment.instantiate_cl_dataset-111"><a href="#CLExperiment.instantiate_cl_dataset-111"><span class="linenos">111</span></a><span class="sd">        - **cl_dataset_cfg** (`DictConfig`): the cl_dataset config dict.</span>
</span><span id="CLExperiment.instantiate_cl_dataset-112"><a href="#CLExperiment.instantiate_cl_dataset-112"><span class="linenos">112</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CLExperiment.instantiate_cl_dataset-113"><a href="#CLExperiment.instantiate_cl_dataset-113"><span class="linenos">113</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment.instantiate_cl_dataset-114"><a href="#CLExperiment.instantiate_cl_dataset-114"><span class="linenos">114</span></a>            <span class="s2">&quot;Instantiating CL dataset &lt;</span><span class="si">%s</span><span class="s2">&gt; (clarena.cl_datasets.CLDataset)...&quot;</span><span class="p">,</span>
</span><span id="CLExperiment.instantiate_cl_dataset-115"><a href="#CLExperiment.instantiate_cl_dataset-115"><span class="linenos">115</span></a>            <span class="n">cl_dataset_cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_target_&quot;</span><span class="p">),</span>
</span><span id="CLExperiment.instantiate_cl_dataset-116"><a href="#CLExperiment.instantiate_cl_dataset-116"><span class="linenos">116</span></a>        <span class="p">)</span>
</span><span id="CLExperiment.instantiate_cl_dataset-117"><a href="#CLExperiment.instantiate_cl_dataset-117"><span class="linenos">117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cl_dataset</span><span class="p">:</span> <span class="n">LightningDataModule</span> <span class="o">=</span> <span class="n">hydra</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">cl_dataset_cfg</span><span class="p">)</span>
</span><span id="CLExperiment.instantiate_cl_dataset-118"><a href="#CLExperiment.instantiate_cl_dataset-118"><span class="linenos">118</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment.instantiate_cl_dataset-119"><a href="#CLExperiment.instantiate_cl_dataset-119"><span class="linenos">119</span></a>            <span class="s2">&quot;CL dataset &lt;</span><span class="si">%s</span><span class="s2">&gt; (clarena.cl_datasets.CLDataset) instantiated!&quot;</span><span class="p">,</span>
</span><span id="CLExperiment.instantiate_cl_dataset-120"><a href="#CLExperiment.instantiate_cl_dataset-120"><span class="linenos">120</span></a>            <span class="n">cl_dataset_cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_target_&quot;</span><span class="p">),</span>
</span><span id="CLExperiment.instantiate_cl_dataset-121"><a href="#CLExperiment.instantiate_cl_dataset-121"><span class="linenos">121</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Instantiate the CL dataset object from cl_dataset config.</p>

<p><strong>Args:</strong></p>

<ul>
<li><strong>cl_dataset_cfg</strong> (<code>DictConfig</code>): the cl_dataset config dict.</li>
</ul>
</div>


                            </div>
                            <div id="CLExperiment.instantiate_backbone" class="classattr">
                                        <input id="CLExperiment.instantiate_backbone-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">instantiate_backbone</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">backbone_cfg</span><span class="p">:</span> <span class="n">omegaconf</span><span class="o">.</span><span class="n">dictconfig</span><span class="o">.</span><span class="n">DictConfig</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CLExperiment.instantiate_backbone-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CLExperiment.instantiate_backbone"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CLExperiment.instantiate_backbone-123"><a href="#CLExperiment.instantiate_backbone-123"><span class="linenos">123</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">instantiate_backbone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">backbone_cfg</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment.instantiate_backbone-124"><a href="#CLExperiment.instantiate_backbone-124"><span class="linenos">124</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Instantiate the CL backbone network object from backbone config.</span>
</span><span id="CLExperiment.instantiate_backbone-125"><a href="#CLExperiment.instantiate_backbone-125"><span class="linenos">125</span></a>
</span><span id="CLExperiment.instantiate_backbone-126"><a href="#CLExperiment.instantiate_backbone-126"><span class="linenos">126</span></a><span class="sd">        **Args:**</span>
</span><span id="CLExperiment.instantiate_backbone-127"><a href="#CLExperiment.instantiate_backbone-127"><span class="linenos">127</span></a><span class="sd">        - **backbone_cfg** (`DictConfig`): the backbone config dict.</span>
</span><span id="CLExperiment.instantiate_backbone-128"><a href="#CLExperiment.instantiate_backbone-128"><span class="linenos">128</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CLExperiment.instantiate_backbone-129"><a href="#CLExperiment.instantiate_backbone-129"><span class="linenos">129</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment.instantiate_backbone-130"><a href="#CLExperiment.instantiate_backbone-130"><span class="linenos">130</span></a>            <span class="s2">&quot;Instantiating backbone network &lt;</span><span class="si">%s</span><span class="s2">&gt; (clarena.backbones.CLBackbone)...&quot;</span><span class="p">,</span>
</span><span id="CLExperiment.instantiate_backbone-131"><a href="#CLExperiment.instantiate_backbone-131"><span class="linenos">131</span></a>            <span class="n">backbone_cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_target_&quot;</span><span class="p">),</span>
</span><span id="CLExperiment.instantiate_backbone-132"><a href="#CLExperiment.instantiate_backbone-132"><span class="linenos">132</span></a>        <span class="p">)</span>
</span><span id="CLExperiment.instantiate_backbone-133"><a href="#CLExperiment.instantiate_backbone-133"><span class="linenos">133</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">backbone</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span> <span class="o">=</span> <span class="n">hydra</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">backbone_cfg</span><span class="p">)</span>
</span><span id="CLExperiment.instantiate_backbone-134"><a href="#CLExperiment.instantiate_backbone-134"><span class="linenos">134</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment.instantiate_backbone-135"><a href="#CLExperiment.instantiate_backbone-135"><span class="linenos">135</span></a>            <span class="s2">&quot;Backbone network &lt;</span><span class="si">%s</span><span class="s2">&gt; (clarena.backbones.CLBackbone) instantiated!&quot;</span><span class="p">,</span>
</span><span id="CLExperiment.instantiate_backbone-136"><a href="#CLExperiment.instantiate_backbone-136"><span class="linenos">136</span></a>            <span class="n">backbone_cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_target_&quot;</span><span class="p">),</span>
</span><span id="CLExperiment.instantiate_backbone-137"><a href="#CLExperiment.instantiate_backbone-137"><span class="linenos">137</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Instantiate the CL backbone network object from backbone config.</p>

<p><strong>Args:</strong></p>

<ul>
<li><strong>backbone_cfg</strong> (<code>DictConfig</code>): the backbone config dict.</li>
</ul>
</div>


                            </div>
                            <div id="CLExperiment.instantiate_heads" class="classattr">
                                        <input id="CLExperiment.instantiate_heads-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">instantiate_heads</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">cl_paradigm</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">input_dim</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CLExperiment.instantiate_heads-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CLExperiment.instantiate_heads"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CLExperiment.instantiate_heads-139"><a href="#CLExperiment.instantiate_heads-139"><span class="linenos">139</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">instantiate_heads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cl_paradigm</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">input_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment.instantiate_heads-140"><a href="#CLExperiment.instantiate_heads-140"><span class="linenos">140</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Instantiate the CL output heads object according to field `cl_paradigm` and backbone `output_dim` in the config.</span>
</span><span id="CLExperiment.instantiate_heads-141"><a href="#CLExperiment.instantiate_heads-141"><span class="linenos">141</span></a>
</span><span id="CLExperiment.instantiate_heads-142"><a href="#CLExperiment.instantiate_heads-142"><span class="linenos">142</span></a><span class="sd">        **Args:**</span>
</span><span id="CLExperiment.instantiate_heads-143"><a href="#CLExperiment.instantiate_heads-143"><span class="linenos">143</span></a><span class="sd">        - **cl_paradigm** (`str`): the CL paradigm, either &#39;TIL&#39; or &#39;CIL&#39;.</span>
</span><span id="CLExperiment.instantiate_heads-144"><a href="#CLExperiment.instantiate_heads-144"><span class="linenos">144</span></a><span class="sd">        - **input_dim** (`int`): the input dimension of the heads. Must be equal to the `output_dim` of the connected backbone.</span>
</span><span id="CLExperiment.instantiate_heads-145"><a href="#CLExperiment.instantiate_heads-145"><span class="linenos">145</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CLExperiment.instantiate_heads-146"><a href="#CLExperiment.instantiate_heads-146"><span class="linenos">146</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment.instantiate_heads-147"><a href="#CLExperiment.instantiate_heads-147"><span class="linenos">147</span></a>            <span class="s2">&quot;CL paradigm is set as </span><span class="si">%s</span><span class="s2">. Instantiating </span><span class="si">%s</span><span class="s2"> heads (torch.nn.Module)...&quot;</span><span class="p">,</span>
</span><span id="CLExperiment.instantiate_heads-148"><a href="#CLExperiment.instantiate_heads-148"><span class="linenos">148</span></a>            <span class="n">cl_paradigm</span><span class="p">,</span>
</span><span id="CLExperiment.instantiate_heads-149"><a href="#CLExperiment.instantiate_heads-149"><span class="linenos">149</span></a>            <span class="n">cl_paradigm</span><span class="p">,</span>
</span><span id="CLExperiment.instantiate_heads-150"><a href="#CLExperiment.instantiate_heads-150"><span class="linenos">150</span></a>        <span class="p">)</span>
</span><span id="CLExperiment.instantiate_heads-151"><a href="#CLExperiment.instantiate_heads-151"><span class="linenos">151</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">heads</span><span class="p">:</span> <span class="n">HeadsTIL</span> <span class="o">|</span> <span class="n">HeadsCIL</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="CLExperiment.instantiate_heads-152"><a href="#CLExperiment.instantiate_heads-152"><span class="linenos">152</span></a>            <span class="n">HeadsTIL</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="n">input_dim</span><span class="p">)</span>
</span><span id="CLExperiment.instantiate_heads-153"><a href="#CLExperiment.instantiate_heads-153"><span class="linenos">153</span></a>            <span class="k">if</span> <span class="n">cl_paradigm</span> <span class="o">==</span> <span class="s2">&quot;TIL&quot;</span>
</span><span id="CLExperiment.instantiate_heads-154"><a href="#CLExperiment.instantiate_heads-154"><span class="linenos">154</span></a>            <span class="k">else</span> <span class="n">HeadsCIL</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="n">input_dim</span><span class="p">)</span>
</span><span id="CLExperiment.instantiate_heads-155"><a href="#CLExperiment.instantiate_heads-155"><span class="linenos">155</span></a>        <span class="p">)</span>
</span><span id="CLExperiment.instantiate_heads-156"><a href="#CLExperiment.instantiate_heads-156"><span class="linenos">156</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> heads (torch.nn.Module) instantiated! &quot;</span><span class="p">,</span> <span class="n">cl_paradigm</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Instantiate the CL output heads object according to field <code><a href="#CLExperiment.cl_paradigm">cl_paradigm</a></code> and backbone <code>output_dim</code> in the config.</p>

<p><strong>Args:</strong></p>

<ul>
<li><strong>cl_paradigm</strong> (<code>str</code>): the CL paradigm, either 'TIL' or 'CIL'.</li>
<li><strong>input_dim</strong> (<code>int</code>): the input dimension of the heads. Must be equal to the <code>output_dim</code> of the connected backbone.</li>
</ul>
</div>


                            </div>
                            <div id="CLExperiment.instantiate_cl_algorithm" class="classattr">
                                        <input id="CLExperiment.instantiate_cl_algorithm-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">instantiate_cl_algorithm</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">cl_algorithm_cfg</span><span class="p">:</span> <span class="n">omegaconf</span><span class="o">.</span><span class="n">dictconfig</span><span class="o">.</span><span class="n">DictConfig</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CLExperiment.instantiate_cl_algorithm-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CLExperiment.instantiate_cl_algorithm"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CLExperiment.instantiate_cl_algorithm-158"><a href="#CLExperiment.instantiate_cl_algorithm-158"><span class="linenos">158</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">instantiate_cl_algorithm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cl_algorithm_cfg</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment.instantiate_cl_algorithm-159"><a href="#CLExperiment.instantiate_cl_algorithm-159"><span class="linenos">159</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Instantiate the cl_algorithm object from cl_algorithm config.</span>
</span><span id="CLExperiment.instantiate_cl_algorithm-160"><a href="#CLExperiment.instantiate_cl_algorithm-160"><span class="linenos">160</span></a>
</span><span id="CLExperiment.instantiate_cl_algorithm-161"><a href="#CLExperiment.instantiate_cl_algorithm-161"><span class="linenos">161</span></a><span class="sd">        **Args:**</span>
</span><span id="CLExperiment.instantiate_cl_algorithm-162"><a href="#CLExperiment.instantiate_cl_algorithm-162"><span class="linenos">162</span></a><span class="sd">        - **cl_algorithm_cfg** (`DictConfig`): the cl_algorithm config dict.</span>
</span><span id="CLExperiment.instantiate_cl_algorithm-163"><a href="#CLExperiment.instantiate_cl_algorithm-163"><span class="linenos">163</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CLExperiment.instantiate_cl_algorithm-164"><a href="#CLExperiment.instantiate_cl_algorithm-164"><span class="linenos">164</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment.instantiate_cl_algorithm-165"><a href="#CLExperiment.instantiate_cl_algorithm-165"><span class="linenos">165</span></a>            <span class="s2">&quot;CL algorithm is set as &lt;</span><span class="si">%s</span><span class="s2">&gt;. Instantiating &lt;</span><span class="si">%s</span><span class="s2">&gt; (clarena.cl_algorithms.CLAlgorithm)...&quot;</span><span class="p">,</span>
</span><span id="CLExperiment.instantiate_cl_algorithm-166"><a href="#CLExperiment.instantiate_cl_algorithm-166"><span class="linenos">166</span></a>            <span class="n">cl_algorithm_cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_target_&quot;</span><span class="p">),</span>
</span><span id="CLExperiment.instantiate_cl_algorithm-167"><a href="#CLExperiment.instantiate_cl_algorithm-167"><span class="linenos">167</span></a>            <span class="n">cl_algorithm_cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_target_&quot;</span><span class="p">),</span>
</span><span id="CLExperiment.instantiate_cl_algorithm-168"><a href="#CLExperiment.instantiate_cl_algorithm-168"><span class="linenos">168</span></a>        <span class="p">)</span>
</span><span id="CLExperiment.instantiate_cl_algorithm-169"><a href="#CLExperiment.instantiate_cl_algorithm-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">:</span> <span class="n">LightningModule</span> <span class="o">=</span> <span class="n">hydra</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span>
</span><span id="CLExperiment.instantiate_cl_algorithm-170"><a href="#CLExperiment.instantiate_cl_algorithm-170"><span class="linenos">170</span></a>            <span class="n">cl_algorithm_cfg</span><span class="p">,</span>
</span><span id="CLExperiment.instantiate_cl_algorithm-171"><a href="#CLExperiment.instantiate_cl_algorithm-171"><span class="linenos">171</span></a>            <span class="n">backbone</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backbone</span><span class="p">,</span>
</span><span id="CLExperiment.instantiate_cl_algorithm-172"><a href="#CLExperiment.instantiate_cl_algorithm-172"><span class="linenos">172</span></a>            <span class="n">heads</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">heads</span><span class="p">,</span>
</span><span id="CLExperiment.instantiate_cl_algorithm-173"><a href="#CLExperiment.instantiate_cl_algorithm-173"><span class="linenos">173</span></a>        <span class="p">)</span>
</span><span id="CLExperiment.instantiate_cl_algorithm-174"><a href="#CLExperiment.instantiate_cl_algorithm-174"><span class="linenos">174</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment.instantiate_cl_algorithm-175"><a href="#CLExperiment.instantiate_cl_algorithm-175"><span class="linenos">175</span></a>            <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">&gt; (clarena.cl_algorithms.CLAlgorithm) instantiated!&quot;</span><span class="p">,</span>
</span><span id="CLExperiment.instantiate_cl_algorithm-176"><a href="#CLExperiment.instantiate_cl_algorithm-176"><span class="linenos">176</span></a>            <span class="n">cl_algorithm_cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_target_&quot;</span><span class="p">),</span>
</span><span id="CLExperiment.instantiate_cl_algorithm-177"><a href="#CLExperiment.instantiate_cl_algorithm-177"><span class="linenos">177</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Instantiate the cl_algorithm object from cl_algorithm config.</p>

<p><strong>Args:</strong></p>

<ul>
<li><strong>cl_algorithm_cfg</strong> (<code>DictConfig</code>): the cl_algorithm config dict.</li>
</ul>
</div>


                            </div>
                            <div id="CLExperiment.instantiate_optimizer" class="classattr">
                                        <input id="CLExperiment.instantiate_optimizer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">instantiate_optimizer</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">optimizer_cfg</span><span class="p">:</span> <span class="n">omegaconf</span><span class="o">.</span><span class="n">dictconfig</span><span class="o">.</span><span class="n">DictConfig</span> <span class="o">|</span> <span class="n">omegaconf</span><span class="o">.</span><span class="n">listconfig</span><span class="o">.</span><span class="n">ListConfig</span>,</span><span class="param">	<span class="n">task_id</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CLExperiment.instantiate_optimizer-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CLExperiment.instantiate_optimizer"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CLExperiment.instantiate_optimizer-179"><a href="#CLExperiment.instantiate_optimizer-179"><span class="linenos">179</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">instantiate_optimizer</span><span class="p">(</span>
</span><span id="CLExperiment.instantiate_optimizer-180"><a href="#CLExperiment.instantiate_optimizer-180"><span class="linenos">180</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">optimizer_cfg</span><span class="p">:</span> <span class="n">DictConfig</span> <span class="o">|</span> <span class="n">ListConfig</span><span class="p">,</span> <span class="n">task_id</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="CLExperiment.instantiate_optimizer-181"><a href="#CLExperiment.instantiate_optimizer-181"><span class="linenos">181</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment.instantiate_optimizer-182"><a href="#CLExperiment.instantiate_optimizer-182"><span class="linenos">182</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Instantiate the optimizer object for task `task_id` from optimizer config.</span>
</span><span id="CLExperiment.instantiate_optimizer-183"><a href="#CLExperiment.instantiate_optimizer-183"><span class="linenos">183</span></a>
</span><span id="CLExperiment.instantiate_optimizer-184"><a href="#CLExperiment.instantiate_optimizer-184"><span class="linenos">184</span></a><span class="sd">        **Args:**</span>
</span><span id="CLExperiment.instantiate_optimizer-185"><a href="#CLExperiment.instantiate_optimizer-185"><span class="linenos">185</span></a><span class="sd">        - **optimizer_cfg** (`DictConfig` or `ListConfig`): the optimizer config dict. If it&#39;s a `ListConfig`, it should contain optimizer config for each task; otherwise, it&#39;s an uniform optimizer config for all tasks.</span>
</span><span id="CLExperiment.instantiate_optimizer-186"><a href="#CLExperiment.instantiate_optimizer-186"><span class="linenos">186</span></a><span class="sd">        - **task_id** (`int`): the target task ID.</span>
</span><span id="CLExperiment.instantiate_optimizer-187"><a href="#CLExperiment.instantiate_optimizer-187"><span class="linenos">187</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CLExperiment.instantiate_optimizer-188"><a href="#CLExperiment.instantiate_optimizer-188"><span class="linenos">188</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">optimizer_cfg</span><span class="p">,</span> <span class="n">ListConfig</span><span class="p">):</span>
</span><span id="CLExperiment.instantiate_optimizer-189"><a href="#CLExperiment.instantiate_optimizer-189"><span class="linenos">189</span></a>            <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Distinct optimizer config is applied to each task.&quot;</span><span class="p">)</span>
</span><span id="CLExperiment.instantiate_optimizer-190"><a href="#CLExperiment.instantiate_optimizer-190"><span class="linenos">190</span></a>            <span class="n">optimizer_cfg</span> <span class="o">=</span> <span class="n">optimizer_cfg</span><span class="p">[</span><span class="n">task_id</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="CLExperiment.instantiate_optimizer-191"><a href="#CLExperiment.instantiate_optimizer-191"><span class="linenos">191</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">optimizer_cfg</span><span class="p">,</span> <span class="n">DictConfig</span><span class="p">):</span>
</span><span id="CLExperiment.instantiate_optimizer-192"><a href="#CLExperiment.instantiate_optimizer-192"><span class="linenos">192</span></a>            <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Uniform optimizer config is applied to all tasks.&quot;</span><span class="p">)</span>
</span><span id="CLExperiment.instantiate_optimizer-193"><a href="#CLExperiment.instantiate_optimizer-193"><span class="linenos">193</span></a>
</span><span id="CLExperiment.instantiate_optimizer-194"><a href="#CLExperiment.instantiate_optimizer-194"><span class="linenos">194</span></a>            <span class="c1"># partially instantiate optimizer as the &#39;params&#39; argument is from Lightning Modules cannot be passed for now.</span>
</span><span id="CLExperiment.instantiate_optimizer-195"><a href="#CLExperiment.instantiate_optimizer-195"><span class="linenos">195</span></a>            <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment.instantiate_optimizer-196"><a href="#CLExperiment.instantiate_optimizer-196"><span class="linenos">196</span></a>                <span class="s2">&quot;Partially instantiating optimizer &lt;</span><span class="si">%s</span><span class="s2">&gt; (torch.optim.Optimizer) for task </span><span class="si">%d</span><span class="s2">...&quot;</span><span class="p">,</span>
</span><span id="CLExperiment.instantiate_optimizer-197"><a href="#CLExperiment.instantiate_optimizer-197"><span class="linenos">197</span></a>                <span class="n">optimizer_cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_target_&quot;</span><span class="p">),</span>
</span><span id="CLExperiment.instantiate_optimizer-198"><a href="#CLExperiment.instantiate_optimizer-198"><span class="linenos">198</span></a>                <span class="n">task_id</span><span class="p">,</span>
</span><span id="CLExperiment.instantiate_optimizer-199"><a href="#CLExperiment.instantiate_optimizer-199"><span class="linenos">199</span></a>            <span class="p">)</span>
</span><span id="CLExperiment.instantiate_optimizer-200"><a href="#CLExperiment.instantiate_optimizer-200"><span class="linenos">200</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">:</span> <span class="n">Optimizer</span> <span class="o">=</span> <span class="n">hydra</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">optimizer_cfg</span><span class="p">)</span>
</span><span id="CLExperiment.instantiate_optimizer-201"><a href="#CLExperiment.instantiate_optimizer-201"><span class="linenos">201</span></a>            <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment.instantiate_optimizer-202"><a href="#CLExperiment.instantiate_optimizer-202"><span class="linenos">202</span></a>                <span class="s2">&quot;Optimizer &lt;</span><span class="si">%s</span><span class="s2">&gt; (torch.optim.Optimizer) partially for task </span><span class="si">%d</span><span class="s2"> instantiated!&quot;</span><span class="p">,</span>
</span><span id="CLExperiment.instantiate_optimizer-203"><a href="#CLExperiment.instantiate_optimizer-203"><span class="linenos">203</span></a>                <span class="n">optimizer_cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_target_&quot;</span><span class="p">),</span>
</span><span id="CLExperiment.instantiate_optimizer-204"><a href="#CLExperiment.instantiate_optimizer-204"><span class="linenos">204</span></a>                <span class="n">task_id</span><span class="p">,</span>
</span><span id="CLExperiment.instantiate_optimizer-205"><a href="#CLExperiment.instantiate_optimizer-205"><span class="linenos">205</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Instantiate the optimizer object for task <code><a href="#CLExperiment.task_id">task_id</a></code> from optimizer config.</p>

<p><strong>Args:</strong></p>

<ul>
<li><strong>optimizer_cfg</strong> (<code>DictConfig</code> or <code>ListConfig</code>): the optimizer config dict. If it's a <code>ListConfig</code>, it should contain optimizer config for each task; otherwise, it's an uniform optimizer config for all tasks.</li>
<li><strong>task_id</strong> (<code>int</code>): the target task ID.</li>
</ul>
</div>


                            </div>
                            <div id="CLExperiment.instantiate_trainer" class="classattr">
                                        <input id="CLExperiment.instantiate_trainer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">instantiate_trainer</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">trainer_cfg</span><span class="p">:</span> <span class="n">omegaconf</span><span class="o">.</span><span class="n">dictconfig</span><span class="o">.</span><span class="n">DictConfig</span>, </span><span class="param"><span class="n">task_id</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CLExperiment.instantiate_trainer-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CLExperiment.instantiate_trainer"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CLExperiment.instantiate_trainer-207"><a href="#CLExperiment.instantiate_trainer-207"><span class="linenos">207</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">instantiate_trainer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer_cfg</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">,</span> <span class="n">task_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment.instantiate_trainer-208"><a href="#CLExperiment.instantiate_trainer-208"><span class="linenos">208</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Instantiate the trainer object for task `task_id` from trainer config.</span>
</span><span id="CLExperiment.instantiate_trainer-209"><a href="#CLExperiment.instantiate_trainer-209"><span class="linenos">209</span></a>
</span><span id="CLExperiment.instantiate_trainer-210"><a href="#CLExperiment.instantiate_trainer-210"><span class="linenos">210</span></a><span class="sd">        **Args:**</span>
</span><span id="CLExperiment.instantiate_trainer-211"><a href="#CLExperiment.instantiate_trainer-211"><span class="linenos">211</span></a><span class="sd">        - **trainer_cfg** (`DictConfig`): the trainer config dict. All tasks share the same trainer config but different objects.</span>
</span><span id="CLExperiment.instantiate_trainer-212"><a href="#CLExperiment.instantiate_trainer-212"><span class="linenos">212</span></a><span class="sd">        - **task_id** (`int`): the target task ID.</span>
</span><span id="CLExperiment.instantiate_trainer-213"><a href="#CLExperiment.instantiate_trainer-213"><span class="linenos">213</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CLExperiment.instantiate_trainer-214"><a href="#CLExperiment.instantiate_trainer-214"><span class="linenos">214</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment.instantiate_trainer-215"><a href="#CLExperiment.instantiate_trainer-215"><span class="linenos">215</span></a>            <span class="s2">&quot;Instantiating trainer &lt;</span><span class="si">%s</span><span class="s2">&gt; (lightning.Trainer) for task </span><span class="si">%d</span><span class="s2">...&quot;</span><span class="p">,</span>
</span><span id="CLExperiment.instantiate_trainer-216"><a href="#CLExperiment.instantiate_trainer-216"><span class="linenos">216</span></a>            <span class="n">trainer_cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_target_&quot;</span><span class="p">),</span>
</span><span id="CLExperiment.instantiate_trainer-217"><a href="#CLExperiment.instantiate_trainer-217"><span class="linenos">217</span></a>            <span class="n">task_id</span><span class="p">,</span>
</span><span id="CLExperiment.instantiate_trainer-218"><a href="#CLExperiment.instantiate_trainer-218"><span class="linenos">218</span></a>        <span class="p">)</span>
</span><span id="CLExperiment.instantiate_trainer-219"><a href="#CLExperiment.instantiate_trainer-219"><span class="linenos">219</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="p">:</span> <span class="n">Trainer</span> <span class="o">=</span> <span class="n">hydra</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span>
</span><span id="CLExperiment.instantiate_trainer-220"><a href="#CLExperiment.instantiate_trainer-220"><span class="linenos">220</span></a>            <span class="n">trainer_cfg</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lightning_loggers</span>
</span><span id="CLExperiment.instantiate_trainer-221"><a href="#CLExperiment.instantiate_trainer-221"><span class="linenos">221</span></a>        <span class="p">)</span>
</span><span id="CLExperiment.instantiate_trainer-222"><a href="#CLExperiment.instantiate_trainer-222"><span class="linenos">222</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment.instantiate_trainer-223"><a href="#CLExperiment.instantiate_trainer-223"><span class="linenos">223</span></a>            <span class="s2">&quot;Trainer &lt;</span><span class="si">%s</span><span class="s2">&gt; (lightning.Trainer) for task </span><span class="si">%d</span><span class="s2"> instantiated!&quot;</span><span class="p">,</span>
</span><span id="CLExperiment.instantiate_trainer-224"><a href="#CLExperiment.instantiate_trainer-224"><span class="linenos">224</span></a>            <span class="n">trainer_cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_target_&quot;</span><span class="p">),</span>
</span><span id="CLExperiment.instantiate_trainer-225"><a href="#CLExperiment.instantiate_trainer-225"><span class="linenos">225</span></a>            <span class="n">task_id</span><span class="p">,</span>
</span><span id="CLExperiment.instantiate_trainer-226"><a href="#CLExperiment.instantiate_trainer-226"><span class="linenos">226</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Instantiate the trainer object for task <code><a href="#CLExperiment.task_id">task_id</a></code> from trainer config.</p>

<p><strong>Args:</strong></p>

<ul>
<li><strong>trainer_cfg</strong> (<code>DictConfig</code>): the trainer config dict. All tasks share the same trainer config but different objects.</li>
<li><strong>task_id</strong> (<code>int</code>): the target task ID.</li>
</ul>
</div>


                            </div>
                            <div id="CLExperiment.instantiate_lightning_loggers" class="classattr">
                                        <input id="CLExperiment.instantiate_lightning_loggers-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">instantiate_lightning_loggers</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">lightning_loggers_cfg</span><span class="p">:</span> <span class="n">omegaconf</span><span class="o">.</span><span class="n">dictconfig</span><span class="o">.</span><span class="n">DictConfig</span>,</span><span class="param">	<span class="n">task_id</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CLExperiment.instantiate_lightning_loggers-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CLExperiment.instantiate_lightning_loggers"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CLExperiment.instantiate_lightning_loggers-228"><a href="#CLExperiment.instantiate_lightning_loggers-228"><span class="linenos">228</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">instantiate_lightning_loggers</span><span class="p">(</span>
</span><span id="CLExperiment.instantiate_lightning_loggers-229"><a href="#CLExperiment.instantiate_lightning_loggers-229"><span class="linenos">229</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">lightning_loggers_cfg</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">,</span> <span class="n">task_id</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="CLExperiment.instantiate_lightning_loggers-230"><a href="#CLExperiment.instantiate_lightning_loggers-230"><span class="linenos">230</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment.instantiate_lightning_loggers-231"><a href="#CLExperiment.instantiate_lightning_loggers-231"><span class="linenos">231</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Instantiate the list of lightning loggers objects for task `task_id` from lightning_loggers config.</span>
</span><span id="CLExperiment.instantiate_lightning_loggers-232"><a href="#CLExperiment.instantiate_lightning_loggers-232"><span class="linenos">232</span></a>
</span><span id="CLExperiment.instantiate_lightning_loggers-233"><a href="#CLExperiment.instantiate_lightning_loggers-233"><span class="linenos">233</span></a><span class="sd">        **Args:**</span>
</span><span id="CLExperiment.instantiate_lightning_loggers-234"><a href="#CLExperiment.instantiate_lightning_loggers-234"><span class="linenos">234</span></a><span class="sd">        - **lightning_loggers_cfg** (`DictConfig`): the lightning_loggers config dict. All tasks share the same lightning_loggers config but different objects.</span>
</span><span id="CLExperiment.instantiate_lightning_loggers-235"><a href="#CLExperiment.instantiate_lightning_loggers-235"><span class="linenos">235</span></a><span class="sd">        - **task_id** (`int`): the target task ID.</span>
</span><span id="CLExperiment.instantiate_lightning_loggers-236"><a href="#CLExperiment.instantiate_lightning_loggers-236"><span class="linenos">236</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CLExperiment.instantiate_lightning_loggers-237"><a href="#CLExperiment.instantiate_lightning_loggers-237"><span class="linenos">237</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment.instantiate_lightning_loggers-238"><a href="#CLExperiment.instantiate_lightning_loggers-238"><span class="linenos">238</span></a>            <span class="s2">&quot;Instantiating Lightning loggers (lightning.Logger) for task </span><span class="si">%d</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">task_id</span>
</span><span id="CLExperiment.instantiate_lightning_loggers-239"><a href="#CLExperiment.instantiate_lightning_loggers-239"><span class="linenos">239</span></a>        <span class="p">)</span>
</span><span id="CLExperiment.instantiate_lightning_loggers-240"><a href="#CLExperiment.instantiate_lightning_loggers-240"><span class="linenos">240</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lightning_loggers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Logger</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="CLExperiment.instantiate_lightning_loggers-241"><a href="#CLExperiment.instantiate_lightning_loggers-241"><span class="linenos">241</span></a>            <span class="n">hydra</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span>
</span><span id="CLExperiment.instantiate_lightning_loggers-242"><a href="#CLExperiment.instantiate_lightning_loggers-242"><span class="linenos">242</span></a>                <span class="n">lightning_logger</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;task_</span><span class="si">{</span><span class="n">task_id</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="CLExperiment.instantiate_lightning_loggers-243"><a href="#CLExperiment.instantiate_lightning_loggers-243"><span class="linenos">243</span></a>            <span class="p">)</span>  <span class="c1"># change the directory name to &quot;task_&quot; prefix in lightning logs</span>
</span><span id="CLExperiment.instantiate_lightning_loggers-244"><a href="#CLExperiment.instantiate_lightning_loggers-244"><span class="linenos">244</span></a>            <span class="k">for</span> <span class="n">lightning_logger</span> <span class="ow">in</span> <span class="n">lightning_loggers_cfg</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="CLExperiment.instantiate_lightning_loggers-245"><a href="#CLExperiment.instantiate_lightning_loggers-245"><span class="linenos">245</span></a>        <span class="p">]</span>
</span><span id="CLExperiment.instantiate_lightning_loggers-246"><a href="#CLExperiment.instantiate_lightning_loggers-246"><span class="linenos">246</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment.instantiate_lightning_loggers-247"><a href="#CLExperiment.instantiate_lightning_loggers-247"><span class="linenos">247</span></a>            <span class="s2">&quot;Lightning loggers (lightning.Logger) for task </span><span class="si">%d</span><span class="s2"> instantiated!&quot;</span><span class="p">,</span> <span class="n">task_id</span>
</span><span id="CLExperiment.instantiate_lightning_loggers-248"><a href="#CLExperiment.instantiate_lightning_loggers-248"><span class="linenos">248</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Instantiate the list of lightning loggers objects for task <code><a href="#CLExperiment.task_id">task_id</a></code> from lightning_loggers config.</p>

<p><strong>Args:</strong></p>

<ul>
<li><strong>lightning_loggers_cfg</strong> (<code>DictConfig</code>): the lightning_loggers config dict. All tasks share the same lightning_loggers config but different objects.</li>
<li><strong>task_id</strong> (<code>int</code>): the target task ID.</li>
</ul>
</div>


                            </div>
                            <div id="CLExperiment.instantiate_callbacks" class="classattr">
                                        <input id="CLExperiment.instantiate_callbacks-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">instantiate_callbacks</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">callbacks_cfg</span><span class="p">:</span> <span class="n">omegaconf</span><span class="o">.</span><span class="n">dictconfig</span><span class="o">.</span><span class="n">DictConfig</span>,</span><span class="param">	<span class="n">task_id</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CLExperiment.instantiate_callbacks-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CLExperiment.instantiate_callbacks"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CLExperiment.instantiate_callbacks-250"><a href="#CLExperiment.instantiate_callbacks-250"><span class="linenos">250</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">instantiate_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callbacks_cfg</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">,</span> <span class="n">task_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment.instantiate_callbacks-251"><a href="#CLExperiment.instantiate_callbacks-251"><span class="linenos">251</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Instantiate the list of callbacks objects for task `task_id` from callbacks config.</span>
</span><span id="CLExperiment.instantiate_callbacks-252"><a href="#CLExperiment.instantiate_callbacks-252"><span class="linenos">252</span></a>
</span><span id="CLExperiment.instantiate_callbacks-253"><a href="#CLExperiment.instantiate_callbacks-253"><span class="linenos">253</span></a><span class="sd">        **Args:**</span>
</span><span id="CLExperiment.instantiate_callbacks-254"><a href="#CLExperiment.instantiate_callbacks-254"><span class="linenos">254</span></a><span class="sd">        - **callbacks_cfg** (`DictConfig`): the callbacks config dict. All tasks share the same callbacks config but different objects.</span>
</span><span id="CLExperiment.instantiate_callbacks-255"><a href="#CLExperiment.instantiate_callbacks-255"><span class="linenos">255</span></a><span class="sd">        - **task_id** (`int`): the target task ID.</span>
</span><span id="CLExperiment.instantiate_callbacks-256"><a href="#CLExperiment.instantiate_callbacks-256"><span class="linenos">256</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CLExperiment.instantiate_callbacks-257"><a href="#CLExperiment.instantiate_callbacks-257"><span class="linenos">257</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment.instantiate_callbacks-258"><a href="#CLExperiment.instantiate_callbacks-258"><span class="linenos">258</span></a>            <span class="s2">&quot;Instantiating callbacks (lightning.Callback) for task </span><span class="si">%d</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">task_id</span>
</span><span id="CLExperiment.instantiate_callbacks-259"><a href="#CLExperiment.instantiate_callbacks-259"><span class="linenos">259</span></a>        <span class="p">)</span>
</span><span id="CLExperiment.instantiate_callbacks-260"><a href="#CLExperiment.instantiate_callbacks-260"><span class="linenos">260</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Callback</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="CLExperiment.instantiate_callbacks-261"><a href="#CLExperiment.instantiate_callbacks-261"><span class="linenos">261</span></a>            <span class="n">hydra</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span> <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">callbacks_cfg</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</span><span id="CLExperiment.instantiate_callbacks-262"><a href="#CLExperiment.instantiate_callbacks-262"><span class="linenos">262</span></a>        <span class="p">]</span>
</span><span id="CLExperiment.instantiate_callbacks-263"><a href="#CLExperiment.instantiate_callbacks-263"><span class="linenos">263</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment.instantiate_callbacks-264"><a href="#CLExperiment.instantiate_callbacks-264"><span class="linenos">264</span></a>            <span class="s2">&quot;Callbacks (lightning.Callback) for task </span><span class="si">%d</span><span class="s2"> instantiated!&quot;</span><span class="p">,</span> <span class="n">task_id</span>
</span><span id="CLExperiment.instantiate_callbacks-265"><a href="#CLExperiment.instantiate_callbacks-265"><span class="linenos">265</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Instantiate the list of callbacks objects for task <code><a href="#CLExperiment.task_id">task_id</a></code> from callbacks config.</p>

<p><strong>Args:</strong></p>

<ul>
<li><strong>callbacks_cfg</strong> (<code>DictConfig</code>): the callbacks config dict. All tasks share the same callbacks config but different objects.</li>
<li><strong>task_id</strong> (<code>int</code>): the target task ID.</li>
</ul>
</div>


                            </div>
                            <div id="CLExperiment.set_global_seed" class="classattr">
                                        <input id="CLExperiment.set_global_seed-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_global_seed</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CLExperiment.set_global_seed-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CLExperiment.set_global_seed"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CLExperiment.set_global_seed-267"><a href="#CLExperiment.set_global_seed-267"><span class="linenos">267</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_global_seed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment.set_global_seed-268"><a href="#CLExperiment.set_global_seed-268"><span class="linenos">268</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Set the global seed for the entire experiment.&quot;&quot;&quot;</span>
</span><span id="CLExperiment.set_global_seed-269"><a href="#CLExperiment.set_global_seed-269"><span class="linenos">269</span></a>        <span class="n">L</span><span class="o">.</span><span class="n">seed_everything</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_seed</span><span class="p">,</span> <span class="n">workers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CLExperiment.set_global_seed-270"><a href="#CLExperiment.set_global_seed-270"><span class="linenos">270</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Global seed is set as </span><span class="si">%d</span><span class="s2">.&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_seed</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Set the global seed for the entire experiment.</p>
</div>


                            </div>
                            <div id="CLExperiment.setup_task_id" class="classattr">
                                        <input id="CLExperiment.setup_task_id-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">setup_task_id</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">task_id</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CLExperiment.setup_task_id-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CLExperiment.setup_task_id"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CLExperiment.setup_task_id-272"><a href="#CLExperiment.setup_task_id-272"><span class="linenos">272</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">setup_task_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment.setup_task_id-273"><a href="#CLExperiment.setup_task_id-273"><span class="linenos">273</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Set up current task_id in the beginning of the continual learning process of a new task.</span>
</span><span id="CLExperiment.setup_task_id-274"><a href="#CLExperiment.setup_task_id-274"><span class="linenos">274</span></a>
</span><span id="CLExperiment.setup_task_id-275"><a href="#CLExperiment.setup_task_id-275"><span class="linenos">275</span></a><span class="sd">        **Args:**</span>
</span><span id="CLExperiment.setup_task_id-276"><a href="#CLExperiment.setup_task_id-276"><span class="linenos">276</span></a><span class="sd">        - **task_id** (`int`): current task_id.</span>
</span><span id="CLExperiment.setup_task_id-277"><a href="#CLExperiment.setup_task_id-277"><span class="linenos">277</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CLExperiment.setup_task_id-278"><a href="#CLExperiment.setup_task_id-278"><span class="linenos">278</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">task_id</span> <span class="o">=</span> <span class="n">task_id</span>
</span></pre></div>


            <div class="docstring"><p>Set up current task_id in the beginning of the continual learning process of a new task.</p>

<p><strong>Args:</strong></p>

<ul>
<li><strong>task_id</strong> (<code>int</code>): current task_id.</li>
</ul>
</div>


                            </div>
                            <div id="CLExperiment.instantiate_global" class="classattr">
                                        <input id="CLExperiment.instantiate_global-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">instantiate_global</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CLExperiment.instantiate_global-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CLExperiment.instantiate_global"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CLExperiment.instantiate_global-280"><a href="#CLExperiment.instantiate_global-280"><span class="linenos">280</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">instantiate_global</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment.instantiate_global-281"><a href="#CLExperiment.instantiate_global-281"><span class="linenos">281</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Instantiate global components for the entire CL experiment from `self.cfg`.&quot;&quot;&quot;</span>
</span><span id="CLExperiment.instantiate_global-282"><a href="#CLExperiment.instantiate_global-282"><span class="linenos">282</span></a>
</span><span id="CLExperiment.instantiate_global-283"><a href="#CLExperiment.instantiate_global-283"><span class="linenos">283</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instantiate_cl_dataset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">cl_dataset</span><span class="p">)</span>
</span><span id="CLExperiment.instantiate_global-284"><a href="#CLExperiment.instantiate_global-284"><span class="linenos">284</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instantiate_backbone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">backbone</span><span class="p">)</span>
</span><span id="CLExperiment.instantiate_global-285"><a href="#CLExperiment.instantiate_global-285"><span class="linenos">285</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instantiate_heads</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">cl_paradigm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">backbone</span><span class="o">.</span><span class="n">output_dim</span><span class="p">)</span>
</span><span id="CLExperiment.instantiate_global-286"><a href="#CLExperiment.instantiate_global-286"><span class="linenos">286</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instantiate_cl_algorithm</span><span class="p">(</span>
</span><span id="CLExperiment.instantiate_global-287"><a href="#CLExperiment.instantiate_global-287"><span class="linenos">287</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">cl_algorithm</span>
</span><span id="CLExperiment.instantiate_global-288"><a href="#CLExperiment.instantiate_global-288"><span class="linenos">288</span></a>        <span class="p">)</span>  <span class="c1"># cl_algorithm should be instantiated after backbone and heads</span>
</span></pre></div>


            <div class="docstring"><p>Instantiate global components for the entire CL experiment from <code>self.cfg</code>.</p>
</div>


                            </div>
                            <div id="CLExperiment.setup_global" class="classattr">
                                        <input id="CLExperiment.setup_global-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">setup_global</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CLExperiment.setup_global-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CLExperiment.setup_global"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CLExperiment.setup_global-290"><a href="#CLExperiment.setup_global-290"><span class="linenos">290</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">setup_global</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment.setup_global-291"><a href="#CLExperiment.setup_global-291"><span class="linenos">291</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Let CL dataset know the CL paradigm to define its CL class map.&quot;&quot;&quot;</span>
</span><span id="CLExperiment.setup_global-292"><a href="#CLExperiment.setup_global-292"><span class="linenos">292</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_global_seed</span><span class="p">()</span>
</span><span id="CLExperiment.setup_global-293"><a href="#CLExperiment.setup_global-293"><span class="linenos">293</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cl_dataset</span><span class="o">.</span><span class="n">set_cl_paradigm</span><span class="p">(</span><span class="n">cl_paradigm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cl_paradigm</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Let CL dataset know the CL paradigm to define its CL class map.</p>
</div>


                            </div>
                            <div id="CLExperiment.instantiate_task_specific" class="classattr">
                                        <input id="CLExperiment.instantiate_task_specific-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">instantiate_task_specific</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CLExperiment.instantiate_task_specific-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CLExperiment.instantiate_task_specific"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CLExperiment.instantiate_task_specific-295"><a href="#CLExperiment.instantiate_task_specific-295"><span class="linenos">295</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">instantiate_task_specific</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment.instantiate_task_specific-296"><a href="#CLExperiment.instantiate_task_specific-296"><span class="linenos">296</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Instantiate task-specific components for the current task `self.task_id` from `self.cfg`.&quot;&quot;&quot;</span>
</span><span id="CLExperiment.instantiate_task_specific-297"><a href="#CLExperiment.instantiate_task_specific-297"><span class="linenos">297</span></a>
</span><span id="CLExperiment.instantiate_task_specific-298"><a href="#CLExperiment.instantiate_task_specific-298"><span class="linenos">298</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instantiate_optimizer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">optimizer</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_id</span><span class="p">)</span>
</span><span id="CLExperiment.instantiate_task_specific-299"><a href="#CLExperiment.instantiate_task_specific-299"><span class="linenos">299</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instantiate_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">callbacks</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_id</span><span class="p">)</span>
</span><span id="CLExperiment.instantiate_task_specific-300"><a href="#CLExperiment.instantiate_task_specific-300"><span class="linenos">300</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instantiate_lightning_loggers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">lightning_loggers</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_id</span><span class="p">)</span>
</span><span id="CLExperiment.instantiate_task_specific-301"><a href="#CLExperiment.instantiate_task_specific-301"><span class="linenos">301</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instantiate_trainer</span><span class="p">(</span>
</span><span id="CLExperiment.instantiate_task_specific-302"><a href="#CLExperiment.instantiate_task_specific-302"><span class="linenos">302</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">trainer</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_id</span>
</span><span id="CLExperiment.instantiate_task_specific-303"><a href="#CLExperiment.instantiate_task_specific-303"><span class="linenos">303</span></a>        <span class="p">)</span>  <span class="c1"># trainer should be instantiated after loggers and callbacks</span>
</span></pre></div>


            <div class="docstring"><p>Instantiate task-specific components for the current task <code>self.task_id</code> from <code>self.cfg</code>.</p>
</div>


                            </div>
                            <div id="CLExperiment.setup_task_specific" class="classattr">
                                        <input id="CLExperiment.setup_task_specific-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">setup_task_specific</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CLExperiment.setup_task_specific-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CLExperiment.setup_task_specific"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CLExperiment.setup_task_specific-305"><a href="#CLExperiment.setup_task_specific-305"><span class="linenos">305</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">setup_task_specific</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment.setup_task_specific-306"><a href="#CLExperiment.setup_task_specific-306"><span class="linenos">306</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Setup task-specific components to get ready for the current task `self.task_id`.&quot;&quot;&quot;</span>
</span><span id="CLExperiment.setup_task_specific-307"><a href="#CLExperiment.setup_task_specific-307"><span class="linenos">307</span></a>
</span><span id="CLExperiment.setup_task_specific-308"><a href="#CLExperiment.setup_task_specific-308"><span class="linenos">308</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cl_dataset</span><span class="o">.</span><span class="n">setup_task_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">task_id</span><span class="p">)</span>
</span><span id="CLExperiment.setup_task_specific-309"><a href="#CLExperiment.setup_task_specific-309"><span class="linenos">309</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">backbone</span><span class="o">.</span><span class="n">setup_task_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">task_id</span><span class="p">)</span>
</span><span id="CLExperiment.setup_task_specific-310"><a href="#CLExperiment.setup_task_specific-310"><span class="linenos">310</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">setup_task_id</span><span class="p">(</span>
</span><span id="CLExperiment.setup_task_specific-311"><a href="#CLExperiment.setup_task_specific-311"><span class="linenos">311</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">task_id</span><span class="p">,</span>
</span><span id="CLExperiment.setup_task_specific-312"><a href="#CLExperiment.setup_task_specific-312"><span class="linenos">312</span></a>            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cl_dataset</span><span class="o">.</span><span class="n">cl_class_map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">task_id</span><span class="p">)),</span>
</span><span id="CLExperiment.setup_task_specific-313"><a href="#CLExperiment.setup_task_specific-313"><span class="linenos">313</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">,</span>
</span><span id="CLExperiment.setup_task_specific-314"><a href="#CLExperiment.setup_task_specific-314"><span class="linenos">314</span></a>        <span class="p">)</span>
</span><span id="CLExperiment.setup_task_specific-315"><a href="#CLExperiment.setup_task_specific-315"><span class="linenos">315</span></a>
</span><span id="CLExperiment.setup_task_specific-316"><a href="#CLExperiment.setup_task_specific-316"><span class="linenos">316</span></a>        <span class="n">pylogger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
</span><span id="CLExperiment.setup_task_specific-317"><a href="#CLExperiment.setup_task_specific-317"><span class="linenos">317</span></a>            <span class="s2">&quot;Datamodule, model and loggers are all set up ready for task </span><span class="si">%d</span><span class="s2">!&quot;</span><span class="p">,</span>
</span><span id="CLExperiment.setup_task_specific-318"><a href="#CLExperiment.setup_task_specific-318"><span class="linenos">318</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">task_id</span><span class="p">,</span>
</span><span id="CLExperiment.setup_task_specific-319"><a href="#CLExperiment.setup_task_specific-319"><span class="linenos">319</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Setup task-specific components to get ready for the current task <code>self.task_id</code>.</p>
</div>


                            </div>
                            <div id="CLExperiment.run_task" class="classattr">
                                        <input id="CLExperiment.run_task-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">run_task</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CLExperiment.run_task-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CLExperiment.run_task"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CLExperiment.run_task-321"><a href="#CLExperiment.run_task-321"><span class="linenos">321</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run_task</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment.run_task-322"><a href="#CLExperiment.run_task-322"><span class="linenos">322</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Fit the model on the current task `self.task_id`. Also test the model if `self.test` is set to True.&quot;&quot;&quot;</span>
</span><span id="CLExperiment.run_task-323"><a href="#CLExperiment.run_task-323"><span class="linenos">323</span></a>
</span><span id="CLExperiment.run_task-324"><a href="#CLExperiment.run_task-324"><span class="linenos">324</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
</span><span id="CLExperiment.run_task-325"><a href="#CLExperiment.run_task-325"><span class="linenos">325</span></a>            <span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
</span><span id="CLExperiment.run_task-326"><a href="#CLExperiment.run_task-326"><span class="linenos">326</span></a>            <span class="n">datamodule</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cl_dataset</span><span class="p">,</span>
</span><span id="CLExperiment.run_task-327"><a href="#CLExperiment.run_task-327"><span class="linenos">327</span></a>        <span class="p">)</span>
</span><span id="CLExperiment.run_task-328"><a href="#CLExperiment.run_task-328"><span class="linenos">328</span></a>
</span><span id="CLExperiment.run_task-329"><a href="#CLExperiment.run_task-329"><span class="linenos">329</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="p">:</span>
</span><span id="CLExperiment.run_task-330"><a href="#CLExperiment.run_task-330"><span class="linenos">330</span></a>            <span class="c1"># test after training and validation</span>
</span><span id="CLExperiment.run_task-331"><a href="#CLExperiment.run_task-331"><span class="linenos">331</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">test</span><span class="p">(</span>
</span><span id="CLExperiment.run_task-332"><a href="#CLExperiment.run_task-332"><span class="linenos">332</span></a>                <span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
</span><span id="CLExperiment.run_task-333"><a href="#CLExperiment.run_task-333"><span class="linenos">333</span></a>                <span class="n">datamodule</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cl_dataset</span><span class="p">,</span>
</span><span id="CLExperiment.run_task-334"><a href="#CLExperiment.run_task-334"><span class="linenos">334</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Fit the model on the current task <code>self.task_id</code>. Also test the model if <code>self.test</code> is set to True.</p>
</div>


                            </div>
                            <div id="CLExperiment.run" class="classattr">
                                        <input id="CLExperiment.run-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">run</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CLExperiment.run-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CLExperiment.run"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CLExperiment.run-336"><a href="#CLExperiment.run-336"><span class="linenos">336</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CLExperiment.run-337"><a href="#CLExperiment.run-337"><span class="linenos">337</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The main method to run the continual learning experiment.&quot;&quot;&quot;</span>
</span><span id="CLExperiment.run-338"><a href="#CLExperiment.run-338"><span class="linenos">338</span></a>
</span><span id="CLExperiment.run-339"><a href="#CLExperiment.run-339"><span class="linenos">339</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instantiate_global</span><span class="p">()</span>
</span><span id="CLExperiment.run-340"><a href="#CLExperiment.run-340"><span class="linenos">340</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setup_global</span><span class="p">()</span>
</span><span id="CLExperiment.run-341"><a href="#CLExperiment.run-341"><span class="linenos">341</span></a>
</span><span id="CLExperiment.run-342"><a href="#CLExperiment.run-342"><span class="linenos">342</span></a>        <span class="c1"># task loop</span>
</span><span id="CLExperiment.run-343"><a href="#CLExperiment.run-343"><span class="linenos">343</span></a>        <span class="k">for</span> <span class="n">task_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_tasks</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>  <span class="c1"># task ID counts from 1</span>
</span><span id="CLExperiment.run-344"><a href="#CLExperiment.run-344"><span class="linenos">344</span></a>
</span><span id="CLExperiment.run-345"><a href="#CLExperiment.run-345"><span class="linenos">345</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">setup_task_id</span><span class="p">(</span><span class="n">task_id</span><span class="p">)</span>
</span><span id="CLExperiment.run-346"><a href="#CLExperiment.run-346"><span class="linenos">346</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">instantiate_task_specific</span><span class="p">()</span>
</span><span id="CLExperiment.run-347"><a href="#CLExperiment.run-347"><span class="linenos">347</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">setup_task_specific</span><span class="p">()</span>
</span><span id="CLExperiment.run-348"><a href="#CLExperiment.run-348"><span class="linenos">348</span></a>
</span><span id="CLExperiment.run-349"><a href="#CLExperiment.run-349"><span class="linenos">349</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">run_task</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>The main method to run the continual learning experiment.</p>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>